<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ì—°ì°¨ê´€ë¦¬ ì‹œìŠ¤í…œ</title>
  
  <!-- ğŸ¨ CSS ìŠ¤íƒ€ì¼ -->
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f5f6fa;
      line-height: 1.6;
    }
    
    /* ğŸ” í—¤ë” */
    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 1rem 2rem;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    
    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    .logo {
      font-size: 1.5rem;
      font-weight: 700;
    }
    
    .header-right {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .notification-icon {
      position: relative;
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      padding: 0.5rem;
      border-radius: 50%;
      cursor: pointer;
      transition: all 0.3s ease;
    }
    
    .notification-icon:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .notification-badge {
      position: absolute;
      top: -5px;
      right: -5px;
      background: #ff4757;
      color: white;
      border-radius: 50%;
      padding: 2px 6px;
      font-size: 0.7rem;
      font-weight: bold;
      display: none;
    }
    
    .user-menu {
      position: relative;
    }
    
    .user-button {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      padding: 0.5rem 1rem;
      border-radius: 25px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      transition: all 0.3s ease;
    }
    
    .user-button:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .user-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 8px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.15);
      padding: 0.5rem 0;
      min-width: 200px;
      display: none;
      z-index: 1001;
      color: #333;
    }
    
    .user-dropdown a {
      display: block;
      padding: 0.75rem 1rem;
      color: #333;
      text-decoration: none;
      transition: background 0.2s ease;
      cursor: pointer;
    }
    
    .user-dropdown a:hover {
      background: #f8f9fa;
    }
    
    /* ğŸ“± ì‚¬ì´ë“œë°” */
    .sidebar {
      width: 250px;
      background: white;
      height: calc(100vh - 70px);
      position: fixed;
      left: 0;
      top: 70px;
      box-shadow: 2px 0 10px rgba(0,0,0,0.1);
      overflow-y: auto;
      transition: transform 0.3s ease;
    }
    
    .sidebar.hidden {
      transform: translateX(-100%);
    }
    
    .menu-item {
      display: block;
      padding: 1rem 1.5rem;
      color: #333;
      text-decoration: none;
      border-bottom: 1px solid #eee;
      transition: all 0.3s ease;
      cursor: pointer;
    }
    
    .menu-item:hover {
      background: #f8f9fa;
      padding-left: 2rem;
    }
    
    .menu-item.active {
      background: #667eea;
      color: white;
      border-left: 4px solid #5a67d8;
    }
    
    .menu-item .icon {
      margin-right: 0.5rem;
    }
    
    /* ğŸ“„ ë©”ì¸ ì½˜í…ì¸  */
    .main-content {
      margin-left: 250px;
      padding: 2rem;
      min-height: calc(100vh - 70px);
      transition: margin-left 0.3s ease;
    }
    
    .main-content.full-width {
      margin-left: 0;
    }
    
    .page {
      display: none;
      animation: fadeIn 0.3s ease-in;
    }
    
    .page.active {
      display: block;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    .page-header {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      margin-bottom: 2rem;
    }
    
    .page-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: #333;
      margin-bottom: 0.5rem;
    }
    
    .page-subtitle {
      color: #666;
    }
    
    /* ğŸ“Š ëŒ€ì‹œë³´ë“œ ì¹´ë“œ */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .dashboard-card {
      background: white;
      padding: 1.5rem;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      transition: transform 0.3s ease;
    }
    
    .dashboard-card:hover {
      transform: translateY(-5px);
    }
    
    .card-icon {
      font-size: 2rem;
      margin-bottom: 1rem;
    }
    
    .card-value {
      font-size: 2rem;
      font-weight: 700;
      color: #333;
      margin-bottom: 0.5rem;
    }
    
    .card-label {
      color: #666;
      font-size: 0.9rem;
    }
    
    /* ğŸ“ í¼ ìŠ¤íƒ€ì¼ */
    .form-container {
      background: white;
      padding: 2rem;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }
    
    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
      margin-bottom: 1.5rem;
    }
    
    .form-group {
      margin-bottom: 1rem;
    }
    
    .form-group label {
      display: block;
      color: #333;
      font-weight: 600;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }
    
    .form-group input,
    .form-group select,
    .form-group textarea {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    .form-group input:focus,
    .form-group select:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .form-group textarea {
      resize: vertical;
      min-height: 100px;
    }
    
    /* ğŸ”˜ ë²„íŠ¼ */
    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
      text-align: center;
    }
    
    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
    }
    
    .btn-success {
      background: #2ed573;
      color: white;
    }
    
    .btn-danger {
      background: #ff4757;
      color: white;
    }
    
    .btn-secondary {
      background: #747d8c;
      color: white;
    }
    
    .btn:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    /* ğŸ“‹ í…Œì´ë¸” */
    .table-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
      overflow: hidden;
    }
    
    .table {
      width: 100%;
      border-collapse: collapse;
    }
    
    .table th,
    .table td {
      padding: 1rem;
      text-align: left;
      border-bottom: 1px solid #eee;
    }
    
    .table th {
      background: #f8f9fa;
      font-weight: 600;
      color: #333;
    }
    
    .table tr:hover {
      background: #f8f9fa;
    }
    
    /* ğŸ·ï¸ ìƒíƒœ ë¼ë²¨ */
    .status-badge {
      padding: 0.25rem 0.75rem;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
    }
    
    .status-pending {
      background: #fff3cd;
      color: #856404;
    }
    
    .status-approved {
      background: #d4edda;
      color: #155724;
    }
    
    .status-rejected {
      background: #f8d7da;
      color: #721c24;
    }
    
    /* ğŸ“± ëª¨ë°”ì¼ ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .sidebar {
        transform: translateX(-100%);
      }
      
      .sidebar.visible {
        transform: translateX(0);
      }
      
      .main-content {
        margin-left: 0;
        padding: 1rem;
      }
      
      .header-content {
        padding: 0 1rem;
      }
      
      .dashboard-grid {
        grid-template-columns: 1fr;
      }
      
      .form-grid {
        grid-template-columns: 1fr;
      }
      
      /* ì§ì› ê´€ë¦¬ ëª¨ë°”ì¼ ìµœì í™” */
      .section-header {
        flex-direction: column;
        align-items: stretch;
        gap: 1rem;
      }
      
      .search-controls {
        flex-direction: column;
        gap: 0.75rem;
      }
      
      .search-input {
        width: 100%;
      }
      
      .btn-reset {
        width: 100%;
        justify-content: center;
      }
      
      /* ëª¨ë°”ì¼ì—ì„œ í…Œì´ë¸” ìŠ¤í¬ë¡¤ */
      .table-container {
        overflow-x: auto;
        -webkit-overflow-scrolling: touch;
      }
      
      .employee-table {
        min-width: 650px;
      }
      
      .employee-table .btn {
        padding: 0.3rem 0.6rem;
        font-size: 0.8rem;
        min-width: 50px;
      }
      
      .employee-table .btn-text {
        display: none;
      }
      
      .employee-table .btn-icon {
        font-size: 1rem;
      }
      
      .info-banner {
        flex-direction: column;
        text-align: center;
      }
      
      .info-icon {
        align-self: center;
        margin-top: 0;
      }
      
      .btn-large {
        width: 100%;
        padding: 1rem;
      }
    }
    
    @media (max-width: 480px) {
      .search-input {
        font-size: 16px; /* iOSì—ì„œ ì¤Œ ë°©ì§€ */
      }
      
      .employee-table th,
      .employee-table td {
        padding: 0.75rem 0.5rem;
      }
      
      .col-email {
        min-width: 150px;
      }
    }
    
    /* ğŸ’¬ ë©”ì‹œì§€ */
    .alert {
      padding: 1rem;
      border-radius: 8px;
      margin-bottom: 1rem;
      border-left: 4px solid;
    }
    
    .alert-success {
      background: #d4edda;
      color: #155724;
      border-color: #28a745;
    }
    
    .alert-error {
      background: #f8d7da;
      color: #721c24;
      border-color: #dc3545;
    }
    
    .alert-info {
      background: #d1ecf1;
      color: #0c5460;
      border-color: #17a2b8;
    }
    
    /* ğŸ‘¥ ì§ì› ê´€ë¦¬ í˜ì´ì§€ ì „ìš© ìŠ¤íƒ€ì¼ */
    .employee-form-section,
    .employee-list-section {
      margin-bottom: 2.5rem;
    }
    
    .section-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 2px solid #e9ecef;
    }
    
    .section-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #333;
      margin: 0;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    /* ì •ë³´ ë°°ë„ˆ ìŠ¤íƒ€ì¼ */
    .info-banner {
      background: linear-gradient(135deg, #e8f4fd 0%, #f1f8ff 100%);
      border: 1px solid #bee5eb;
      border-radius: 12px;
      padding: 1.5rem;
      margin-bottom: 2rem;
      display: flex;
      align-items: flex-start;
      gap: 1rem;
      box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    }
    
    .info-icon {
      font-size: 1.5rem;
      margin-top: 0.2rem;
    }
    
    .info-content {
      flex: 1;
      color: #0c5460;
    }
    
    .info-content strong {
      display: block;
      margin-bottom: 0.5rem;
      font-size: 1.1rem;
    }
    
    .info-list {
      margin: 0;
      padding-left: 1.2rem;
      list-style: none;
    }
    
    .info-list li {
      position: relative;
      margin-bottom: 0.3rem;
      padding-left: 0.5rem;
    }
    
    .info-list li::before {
      content: 'â€¢';
      position: absolute;
      left: -0.8rem;
      color: #667eea;
      font-weight: bold;
    }
    
    .info-list code {
      background: rgba(255, 255, 255, 0.8);
      padding: 0.2rem 0.4rem;
      border-radius: 4px;
      font-family: 'Courier New', monospace;
      font-weight: bold;
      color: #e74c3c;
    }
    
    /* í¼ ì•¡ì…˜ ë²„íŠ¼ ì˜ì—­ */
    .form-actions {
      text-align: center;
      margin-top: 2.5rem;
      padding-top: 2rem;
      border-top: 1px solid #e9ecef;
    }
    
    .btn-large {
      padding: 1rem 2.5rem;
      font-size: 1.1rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.7rem;
      min-width: 180px;
      justify-content: center;
    }
    
    .btn-icon {
      font-size: 1.2rem;
    }
    
    .btn-text {
      font-weight: 600;
    }
    
    /* ê²€ìƒ‰ ì»¨íŠ¸ë¡¤ */
    .search-controls {
      display: flex;
      align-items: center;
      gap: 1rem;
    }
    
    .search-input-wrapper {
      position: relative;
    }
    
    .search-input {
      padding: 0.75rem 1rem;
      border: 2px solid #e1e5e9;
      border-radius: 8px;
      width: 280px;
      font-size: 0.95rem;
      transition: all 0.3s ease;
      background-color: #f8f9fa;
    }
    
    .search-input:focus {
      outline: none;
      border-color: #667eea;
      background-color: white;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .btn-reset {
      padding: 0.75rem 1.2rem;
      font-size: 0.9rem;
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      min-width: 100px;
      justify-content: center;
    }
    
    /* ì§ì› í…Œì´ë¸” ê°œì„  */
    .employee-table {
      margin: 0;
    }
    
    .employee-table th {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      color: #495057;
      font-weight: 700;
      text-align: center;
      vertical-align: middle;
      padding: 1rem 0.75rem;
      border-bottom: 2px solid #dee2e6;
      white-space: nowrap;
    }
    
    .employee-table td {
      text-align: center;
      vertical-align: middle;
      padding: 1rem 0.75rem;
      border-bottom: 1px solid #e9ecef;
    }
    
    .employee-table tbody tr {
      transition: all 0.2s ease;
    }
    
    .employee-table tbody tr:hover {
      background-color: #f8f9fa;
      transform: translateY(-1px);
      box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
    }
    
    /* í…Œì´ë¸” ì»¬ëŸ¼ ë„ˆë¹„ ì¡°ì • */
    .col-empid {
      width: 10%;
      min-width: 80px;
    }
    
    .col-name {
      width: 15%;
      min-width: 100px;
    }
    
    .col-email {
      width: 25%;
      min-width: 200px;
      text-align: left !important;
      padding-left: 1rem !important;
    }
    
    .col-dept {
      width: 15%;
      min-width: 100px;
    }
    
    .col-position {
      width: 15%;
      min-width: 100px;
    }
    
    .col-actions {
      width: 20%;
      min-width: 160px;
    }
    
    /* í…Œì´ë¸” ì•¡ì…˜ ë²„íŠ¼ */
    .employee-table .btn {
      padding: 0.4rem 0.8rem;
      font-size: 0.85rem;
      font-weight: 600;
      margin: 0 0.2rem;
      min-width: 60px;
    }
    
    /* ë¡œë”© ì…€ */
    .loading-cell {
      text-align: center !important;
      color: #6c757d;
      font-style: italic;
      padding: 2rem !important;
      background: linear-gradient(90deg, #f8f9fa 0%, #e9ecef 50%, #f8f9fa 100%);
      background-size: 200% 100%;
      animation: shimmer 1.5s ease-in-out infinite;
    }
    
    @keyframes shimmer {
      0% { background-position: -200% 0; }
      100% { background-position: 200% 0; }
    }
    
    /* ë¹ˆ ë©”ì‹œì§€ ì…€ */
    .empty-message {
      text-align: center !important;
      color: #6c757d;
      font-style: italic;
      padding: 2.5rem !important;
      background: #f8f9fa;
      font-size: 1.1rem;
    }
    
    .search-empty-message {
      text-align: center !important;
      color: #856404;
      font-style: italic;
      padding: 2.5rem !important;
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      font-size: 1.1rem;
    }
    
    /* ğŸ”„ ë¡œë”© */
    .loading {
      text-align: center;
      padding: 2rem;
      color: #666;
    }
    
    .loading::after {
      content: '...';
      animation: dots 1.5s steps(4, end) infinite;
    }
    
    @keyframes dots {
      0%, 20% { content: '.'; }
      40% { content: '..'; }
      60% { content: '...'; }
      80%, 100% { content: ''; }
    }
    
    /* ì•Œë¦¼ ì• ë‹ˆë©”ì´ì…˜ */
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
    
    @keyframes slideOut {
      from {
        transform: translateX(0);
        opacity: 1;
      }
      to {
        transform: translateX(100%);
        opacity: 0;
      }
    }
    
    /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #3498db;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 2s linear infinite;
      margin-bottom: 10px;
    }
    
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    /* ğŸ”§ ì§ì› ìˆ˜ì • ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 2000;
      animation: fadeIn 0.3s ease-out;
    }
    
    .modal-container {
      background: white;
      border-radius: 12px;
      box-shadow: 0 20px 40px rgba(0,0,0,0.2);
      width: 90%;
      max-width: 500px;
      max-height: 90vh;
      overflow-y: auto;
      animation: slideIn 0.3s ease-out;
    }
    
    .modal-header {
      padding: 1.5rem;
      border-bottom: 1px solid #e9ecef;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .modal-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: #333;
      margin: 0;
    }
    
    .modal-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      cursor: pointer;
      padding: 0.5rem;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s ease;
    }
    
    .modal-close:hover {
      background: #f8f9fa;
      color: #dc3545;
    }
    
    .modal-body {
      padding: 1.5rem;
    }
    
    .modal-footer {
      padding: 1rem 1.5rem;
      border-top: 1px solid #e9ecef;
      display: flex;
      justify-content: flex-end;
      gap: 1rem;
    }
    
    .form-row {
      display: flex;
      gap: 1rem;
    }
    
    .form-col {
      flex: 1;
    }
    
    .form-group-modal {
      margin-bottom: 1.5rem;
    }
    
    .form-group-modal label {
      display: block;
      color: #333;
      font-weight: 600;
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }
    
    .form-group-modal input,
    .form-group-modal select {
      width: 100%;
      padding: 0.75rem;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
      transition: all 0.3s ease;
    }
    
    .form-group-modal input:focus,
    .form-group-modal select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }
    
    .form-group-modal input[readonly] {
      background-color: #f8f9fa;
      color: #6c757d;
    }
    
    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-top: 1rem;
      padding: 1rem;
      background: #fff3cd;
      border: 1px solid #ffeaa7;
      border-radius: 8px;
    }
    
    .checkbox-group input[type="checkbox"] {
      width: auto;
      margin: 0;
    }
    
    .checkbox-group label {
      color: #856404;
      font-weight: 600;
      margin: 0;
    }
    
    .btn-modal {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .btn-modal-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }
    
    .btn-modal-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(102, 126, 234, 0.3);
    }
    
    .btn-modal-secondary {
      background: #6c757d;
      color: white;
    }
    
    .btn-modal-secondary:hover {
      background: #5a6268;
    }
    
    .btn-modal:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }
    
    @keyframes slideIn {
      from { opacity: 0; transform: translateY(-50px); }
      to { opacity: 1; transform: translateY(0); }
    }
    
    /* ğŸ“„ í˜ì´ì§€ë„¤ì´ì…˜ ìŠ¤íƒ€ì¼ */
    .pagination-container {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin: 1.5rem 0;
      padding: 1rem;
      background: #f8f9fa;
      border-radius: 8px;
      border: 1px solid #e9ecef;
    }
    
    .pagination-info {
      color: #6c757d;
      font-size: 0.9rem;
      font-weight: 500;
    }
    
    .pagination-controls {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    
    .pagination-btn {
      padding: 0.5rem 0.75rem;
      border: 1px solid #dee2e6;
      background: white;
      border-radius: 6px;
      cursor: pointer;
      transition: all 0.2s ease;
      font-size: 0.85rem;
      font-weight: 500;
      min-width: 40px;
      text-align: center;
      text-decoration: none;
    }
    
    .pagination-btn:hover {
      background: #e9ecef;
      border-color: #adb5bd;
    }
    
    .pagination-btn.active {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-color: #667eea;
    }
    
    .pagination-btn:disabled {
      background: #f8f9fa;
      color: #6c757d;
      cursor: not-allowed;
      opacity: 0.6;
    }
    
    .pagination-btn:disabled:hover {
      background: #f8f9fa;
      border-color: #dee2e6;
    }
    
    .pagination-select {
      padding: 0.4rem 0.6rem;
      border: 1px solid #dee2e6;
      border-radius: 6px;
      font-size: 0.85rem;
      margin-left: 0.5rem;
    }
    
    .pagination-select:focus {
      outline: none;
      border-color: #667eea;
      box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.1);
    }
    
    /* í˜ì´ì§€ë„¤ì´ì…˜ ì„¤ì • */
    .pagination-settings {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.85rem;
      color: #6c757d;
    }
    
    /* ëª¨ë°”ì¼ ë°˜ì‘í˜• */
    @media (max-width: 768px) {
      .modal-container {
        width: 95%;
        max-height: 95vh;
        margin: 1rem;
      }
      
      .modal-header,
      .modal-body,
      .modal-footer {
        padding: 1rem;
      }
      
      .form-row {
        flex-direction: column;
        gap: 0;
      }
      
      .modal-footer {
        flex-direction: column;
        gap: 0.5rem;
      }
      
      .btn-modal {
        width: 100%;
        justify-content: center;
      }
      
      /* í˜ì´ì§€ë„¤ì´ì…˜ ëª¨ë°”ì¼ ìµœì í™” */
      .pagination-container {
        flex-direction: column;
        gap: 1rem;
        padding: 0.75rem;
      }
      
      .pagination-info {
        order: 2;
        text-align: center;
      }
      
      .pagination-controls {
        order: 1;
        flex-wrap: wrap;
        justify-content: center;
      }
      
      .pagination-settings {
        order: 3;
        justify-content: center;
      }
      
      .pagination-btn {
        padding: 0.4rem 0.6rem;
        font-size: 0.8rem;
        min-width: 35px;
      }
    }
  </style>
</head>

<body>
  <!-- ğŸ” í—¤ë” -->
  <header class="header">
    <div class="header-content">
      <div class="logo">
        ğŸ“‹ ì—°ì°¨ê´€ë¦¬ ì‹œìŠ¤í…œ
      </div>
      
      <div class="header-right">
        <!-- ğŸ“¢ ì•Œë¦¼ ì•„ì´ì½˜ -->
        <button class="notification-icon" onclick="showNotifications()">
          ğŸ””
          <span id="notificationBadge" class="notification-badge">0</span>
        </button>
        
        <!-- ğŸ‘¤ ì‚¬ìš©ì ë©”ë‰´ -->
        <div class="user-menu">
          <button class="user-button" onclick="toggleUserMenu()">
            <? if (user.userType === 'admin') { ?>
              ğŸ” <?= user.name ?> (ê´€ë¦¬ì)
            <? } else { ?>
              ğŸ‘¤ <?= user.name ?>
            <? } ?>
            <span style="margin-left: 0.5rem;">â–¼</span>
          </button>
          
          <div id="userDropdown" class="user-dropdown">
            <a onclick="showPage('myInfo')">ğŸ‘¤ ë‚´ ì •ë³´</a>
            <a onclick="showPage('changePassword')">ğŸ”‘ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</a>
            <? if (user.isAdmin) { ?>
              <a onclick="showPage('adminMenu')">ğŸ”§ ê´€ë¦¬ì ë©”ë‰´</a>
            <? } ?>
            <a onclick="logout()">ğŸšª ë¡œê·¸ì•„ì›ƒ</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <!-- ğŸ“± ì‚¬ì´ë“œë°” -->
  <nav class="sidebar" id="sidebar">
    <a class="menu-item active" onclick="showPage('dashboard')">
      <span class="icon">ğŸ </span> ëŒ€ì‹œë³´ë“œ
    </a>
    <? if (user.userType === 'admin') { ?>
      <!-- ê´€ë¦¬ì ì „ìš© ë©”ë‰´ -->
      <a class="menu-item" onclick="showPage('employeeManagement')">
        <span class="icon">ğŸ‘¥</span> ì§ì› ê´€ë¦¬
      </a>
      <a class="menu-item" onclick="showPage('departmentManagement')">
        <span class="icon">ğŸ¢</span> ë¶€ì„œ ê´€ë¦¬
      </a>
      <a class="menu-item" onclick="showPage('statistics')">
        <span class="icon">ğŸ“ˆ</span> í†µê³„ ë° ë³´ê³ ì„œ
      </a>
      <a class="menu-item" onclick="showPage('systemSettings')">
        <span class="icon">âš™ï¸</span> ì„¤ì •
      </a>
    <? } else { ?>
      <!-- ì§ì› ì „ìš© ë©”ë‰´ -->
      <a class="menu-item" onclick="showPage('leaveRequest')">
        <span class="icon">ğŸ“</span> ì—°ì°¨ ì‹ ì²­
      </a>
      <a class="menu-item" onclick="showPage('myRequests')">
        <span class="icon">ğŸ“Š</span> ë‚´ ì‹ ì²­ í˜„í™©
      </a>
      <a class="menu-item" onclick="showPage('approvals')">
        <span class="icon">âœ…</span> ê²°ì¬/í˜‘ì¡° ì²˜ë¦¬
      </a>
      <? if (user.isAdmin) { ?>
        <a class="menu-item" onclick="showPage('adminMenu')">
          <span class="icon">ğŸ”§</span> ê´€ë¦¬ì ë©”ë‰´
        </a>
      <? } ?>
    <? } ?>
  </nav>

  <!-- ğŸ“„ ë©”ì¸ ì½˜í…ì¸  -->
  <main class="main-content" id="mainContent">
    
    <!-- ğŸ  ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ -->
    <div id="dashboardPage" class="page active">
      <div class="page-header">
        <h1 class="page-title">ğŸ  ëŒ€ì‹œë³´ë“œ</h1>
        <? if (user.userType === 'admin') { ?>
          <p class="page-subtitle">ì•ˆë…•í•˜ì„¸ìš”, <?= user.name ?> ê´€ë¦¬ìë‹˜! ì‹œìŠ¤í…œ ê´€ë¦¬ ëŒ€ì‹œë³´ë“œì…ë‹ˆë‹¤.</p>
        <? } else { ?>
          <p class="page-subtitle">ì•ˆë…•í•˜ì„¸ìš”, <?= user.name ?>ë‹˜! ì—°ì°¨ í˜„í™©ì„ í™•ì¸í•´ë³´ì„¸ìš”.</p>
        <? } ?>
      </div>
      
      <? if (user.userType === 'admin') { ?>
        <!-- ê´€ë¦¬ììš© ì‹œìŠ¤í…œ í˜„í™© ëŒ€ì‹œë³´ë“œ -->
        <div class="dashboard-grid">
          <div class="dashboard-card">
            <div class="card-icon">ğŸ‘¥</div>
            <div class="card-value" id="totalEmployees">-</div>
            <div class="card-label">ì „ì²´ ì§ì› ìˆ˜</div>
          </div>
          
          <div class="dashboard-card">
            <div class="card-icon">ğŸ“</div>
            <div class="card-value" id="totalRequests">-</div>
            <div class="card-label">ì´ ì—°ì°¨ ì‹ ì²­</div>
          </div>
          
          <div class="dashboard-card">
            <div class="card-icon">âœ…</div>
            <div class="card-value" id="approvedRequests">-</div>
            <div class="card-label">ìŠ¹ì¸ëœ ì‹ ì²­</div>
          </div>
          
          <div class="dashboard-card">
            <div class="card-icon">ğŸ¢</div>
            <div class="card-value" id="totalDepartments">-</div>
            <div class="card-label">ì „ì²´ ë¶€ì„œ ìˆ˜</div>
          </div>
        </div>
      <? } else { ?>
        <!-- ì§ì›ìš© ê°œì¸ ì—°ì°¨ ëŒ€ì‹œë³´ë“œ -->
        <div class="dashboard-grid">
          <div class="dashboard-card">
            <div class="card-icon">ğŸ“…</div>
            <div class="card-value" id="remainingLeaves">-</div>
            <div class="card-label">ë‚¨ì€ ì—°ì°¨</div>
          </div>
          
          <div class="dashboard-card">
            <div class="card-icon">ğŸ“</div>
            <div class="card-value" id="pendingRequests">-</div>
            <div class="card-label">ëŒ€ê¸° ì¤‘ì¸ ì‹ ì²­</div>
          </div>
          
          <div class="dashboard-card">
            <div class="card-icon">âœ…</div>
            <div class="card-value" id="pendingApprovals">-</div>
            <div class="card-label">ê²°ì¬ ëŒ€ê¸°</div>
          </div>
          
          <div class="dashboard-card">
            <div class="card-icon">ğŸ“Š</div>
            <div class="card-value" id="thisMonthUsed">-</div>
            <div class="card-label">ì´ë²ˆ ë‹¬ ì‚¬ìš©</div>
          </div>
        </div>
      <? } ?>
      
      <!-- ìµœê·¼ í™œë™ -->
      <? if (user.userType === 'admin') { ?>
        <!-- ê´€ë¦¬ììš© ì‹œìŠ¤í…œ ê´€ë¦¬ ë°”ë¡œê°€ê¸° -->
        <div class="recent-activity">
          <h3 style="padding: 1rem; margin: 0; background: #f8f9fa; font-weight: 600;">ğŸ”§ ê´€ë¦¬ ë°”ë¡œê°€ê¸°</h3>
          <div class="dashboard-grid" style="grid-template-columns: repeat(2, 1fr); gap: 1.5rem; padding: 1.5rem;">
            <div class="dashboard-card" onclick="showPage('employeeManagement')" style="cursor: pointer;">
              <div class="card-icon">ğŸ‘¥</div>
              <div class="card-value">ì§ì› ê´€ë¦¬</div>
              <div class="card-label">ì§ì› ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ</div>
            </div>
            
            <div class="dashboard-card" onclick="showPage('departmentManagement')" style="cursor: pointer;">
              <div class="card-icon">ğŸ¢</div>
              <div class="card-value">ë¶€ì„œ ê´€ë¦¬</div>
              <div class="card-label">ë¶€ì„œ ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ</div>
            </div>
          </div>
        </div>
      <? } else { ?>
        <!-- ì§ì›ìš© ìµœê·¼ ì‹ ì²­ ë‚´ì—­ -->
        <div class="table-container">
          <h3 style="padding: 1rem; margin: 0; background: #f8f9fa; font-weight: 600;">ìµœê·¼ ì—°ì°¨ ì‹ ì²­ ë‚´ì—­</h3>
          <table class="table">
            <thead>
              <tr>
                <th>ì‹ ì²­ì¼</th>
                <th>ì—°ì°¨ ì¢…ë¥˜</th>
                <th>ê¸°ê°„</th>
                <th>ìƒíƒœ</th>
                <th>ì‚¬ìœ </th>
              </tr>
            </thead>
            <tbody id="recentRequestsTable">
              <tr>
                <td colspan="5" class="loading">ìµœê·¼ ë‚´ì—­ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤</td>
              </tr>
            </tbody>
          </table>
        </div>
      <? } ?>
    </div>

    <!-- ğŸ“ ì—°ì°¨ ì‹ ì²­ í˜ì´ì§€ -->
    <div id="leaveRequestPage" class="page">
      <div class="page-header">
        <h1 class="page-title">ğŸ“ ì—°ì°¨ ì‹ ì²­</h1>
        <p class="page-subtitle">ì—°ì°¨ë¥¼ ì‹ ì²­í•˜ê³  ê²°ì¬ì/í˜‘ì¡°ìë¥¼ ì„ íƒí•˜ì„¸ìš”.</p>
      </div>
      
      <div class="form-container">
        <form id="leaveRequestForm" onsubmit="submitLeaveRequest(event)">
          <div class="form-grid">
            <div class="form-group">
              <label for="startDate">ì‹œì‘ì¼ *</label>
              <input type="date" id="startDate" required onchange="calculateLeaveDays()">
            </div>
            
            <div class="form-group">
              <label for="endDate">ì¢…ë£Œì¼ *</label>
              <input type="date" id="endDate" required onchange="calculateLeaveDays()">
            </div>
            
            <div class="form-group">
              <label for="leaveType">ì—°ì°¨ ì¢…ë¥˜ *</label>
              <select id="leaveType" required onchange="calculateLeaveDays()">
                <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                <option value="ì—°ì°¨">ì—°ì°¨</option>
                <option value="ë°˜ì°¨">ë°˜ì°¨</option>
                <option value="íŠ¹ë³„íœ´ê°€">íŠ¹ë³„íœ´ê°€</option>
              </select>
            </div>
            
            <div class="form-group">
              <label for="calculatedDays">ê³„ì‚°ëœ ì¼ìˆ˜</label>
              <input type="text" id="calculatedDays" readonly placeholder="ìë™ ê³„ì‚°ë©ë‹ˆë‹¤">
            </div>
          </div>
          
          <div class="form-group">
            <label for="reason">ì‹ ì²­ ì‚¬ìœ  *</label>
            <textarea id="reason" required placeholder="ì—°ì°¨ ì‹ ì²­ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”"></textarea>
          </div>
          
          <!-- ê²°ì¬ì ì„ íƒ -->
          <div class="form-group">
            <label>ê²°ì¬ì ì„ íƒ *</label>
            <button type="button" class="btn btn-secondary" onclick="openApproverModal()">
              ğŸ” ê²°ì¬ì ì¶”ê°€
            </button>
            <div id="selectedApprovers" style="margin-top: 1rem;">
              <!-- ì„ íƒëœ ê²°ì¬ìë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
          </div>
          
          <!-- í˜‘ì¡°ì ì„ íƒ -->
          <div class="form-group">
            <label>í˜‘ì¡°ì ì„ íƒ (ì„ íƒì‚¬í•­)</label>
            <button type="button" class="btn btn-secondary" onclick="openCollaboratorModal()">
              ğŸ” í˜‘ì¡°ì ì¶”ê°€
            </button>
            <div id="selectedCollaborators" style="margin-top: 1rem;">
              <!-- ì„ íƒëœ í˜‘ì¡°ìë“¤ì´ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤ -->
            </div>
          </div>
          
          <div style="text-align: center; margin-top: 2rem;">
            <button type="submit" class="btn btn-primary" id="submitLeaveBtn">
              ğŸ“ ì—°ì°¨ ì‹ ì²­í•˜ê¸°
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- ğŸ“Š ë‚´ ì‹ ì²­ í˜„í™© í˜ì´ì§€ -->
    <div id="myRequestsPage" class="page">
      <div class="page-header">
        <h1 class="page-title">ğŸ“Š ë‚´ ì‹ ì²­ í˜„í™©</h1>
        <p class="page-subtitle">ë‚´ê°€ ì‹ ì²­í•œ ì—°ì°¨ì˜ ì§„í–‰ ìƒí™©ì„ í™•ì¸í•˜ì„¸ìš”.</p>
      </div>
      
      <div class="table-container">
        <table class="table">
          <thead>
            <tr>
              <th>ì‹ ì²­ID</th>
              <th>ì‹ ì²­ì¼</th>
              <th>ì—°ì°¨ ì¢…ë¥˜</th>
              <th>ê¸°ê°„</th>
              <th>ì¼ìˆ˜</th>
              <th>ìƒíƒœ</th>
              <th>ì‚¬ìœ </th>
              <th>ê²°ì¬ í˜„í™©</th>
            </tr>
          </thead>
          <tbody id="myRequestsTable">
            <tr>
              <td colspan="8" class="loading">ë‚´ ì‹ ì²­ í˜„í™©ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- âœ… ê²°ì¬/í˜‘ì¡° ì²˜ë¦¬ í˜ì´ì§€ -->
    <div id="approvalsPage" class="page">
      <div class="page-header">
        <h1 class="page-title">âœ… ê²°ì¬/í˜‘ì¡° ì²˜ë¦¬</h1>
        <p class="page-subtitle">ë‚˜ì—ê²Œ í• ë‹¹ëœ ê²°ì¬ ë° í˜‘ì¡° ê±´ì„ ì²˜ë¦¬í•˜ì„¸ìš”.</p>
      </div>
      
      <!-- ê²°ì¬ ëŒ€ê¸° ëª©ë¡ -->
      <div class="table-container" style="margin-bottom: 2rem;">
        <h3 style="padding: 1rem; margin: 0; background: #fff3cd; color: #856404; font-weight: 600;">
          ğŸ”¶ ê²°ì¬ ëŒ€ê¸° ëª©ë¡
        </h3>
        <table class="table">
          <thead>
            <tr>
              <th>ì‹ ì²­ID</th>
              <th>ì‹ ì²­ì</th>
              <th>ì—°ì°¨ ì¢…ë¥˜</th>
              <th>ê¸°ê°„</th>
              <th>ì¼ìˆ˜</th>
              <th>ì‚¬ìœ </th>
              <th>ì²˜ë¦¬</th>
            </tr>
          </thead>
          <tbody id="pendingApprovalsTable">
            <tr>
              <td colspan="7" class="loading">ê²°ì¬ ëŒ€ê¸° ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤</td>
            </tr>
          </tbody>
        </table>
      </div>
      
      <!-- í˜‘ì¡° ëŒ€ê¸° ëª©ë¡ -->
      <div class="table-container">
        <h3 style="padding: 1rem; margin: 0; background: #d1ecf1; color: #0c5460; font-weight: 600;">
          ğŸ”· í˜‘ì¡° ëŒ€ê¸° ëª©ë¡
        </h3>
        <table class="table">
          <thead>
            <tr>
              <th>ì‹ ì²­ID</th>
              <th>ì‹ ì²­ì</th>
              <th>ì—°ì°¨ ì¢…ë¥˜</th>
              <th>ê¸°ê°„</th>
              <th>ì¼ìˆ˜</th>
              <th>ì‚¬ìœ </th>
              <th>ì²˜ë¦¬</th>
            </tr>
          </thead>
          <tbody id="pendingCollaborationsTable">
            <tr>
              <td colspan="7" class="loading">í˜‘ì¡° ëŒ€ê¸° ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ğŸ‘¤ ë‚´ ì •ë³´ í˜ì´ì§€ -->
    <div id="myInfoPage" class="page">
      <div class="page-header">
        <h1 class="page-title">ğŸ‘¤ ë‚´ ì •ë³´</h1>
        <p class="page-subtitle">ê°œì¸ ì •ë³´ì™€ ì—°ì°¨ í˜„í™©ì„ í™•ì¸í•˜ì„¸ìš”.</p>
      </div>
      
      <div class="form-container">
        <div class="form-grid">
          <div class="form-group">
            <label>ì‚¬ë²ˆ</label>
            <input type="text" value="<?= user.empId ?>" readonly>
          </div>
          
          <div class="form-group">
            <label>ì´ë¦„</label>
            <input type="text" value="<?= user.name ?>" readonly>
          </div>
          
          <div class="form-group">
            <label>ì´ë©”ì¼</label>
            <input type="text" value="<?= user.email ?>" readonly>
          </div>
          
          <div class="form-group">
            <label>ì§ê¸‰</label>
            <input type="text" value="<?= user.position ?>" readonly>
          </div>
        </div>
        
        <div id="myLeaveInfo" class="dashboard-grid" style="margin-top: 2rem;">
          <!-- ì—°ì°¨ ì •ë³´ê°€ ì—¬ê¸°ì— ë¡œë“œë©ë‹ˆë‹¤ -->
        </div>
      </div>
    </div>

    <!-- ğŸ”‘ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í˜ì´ì§€ -->
    <div id="changePasswordPage" class="page">
      <div class="page-header">
        <h1 class="page-title">ğŸ”‘ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½</h1>
        <p class="page-subtitle">ë³´ì•ˆì„ ìœ„í•´ ì£¼ê¸°ì ìœ¼ë¡œ ë¹„ë°€ë²ˆí˜¸ë¥¼ ë³€ê²½í•˜ì„¸ìš”.</p>
      </div>
      
      <div class="form-container">
        <form id="changePasswordForm" onsubmit="changePassword(event)">
          <div class="form-group">
            <label for="currentPassword">í˜„ì¬ ë¹„ë°€ë²ˆí˜¸ *</label>
            <input type="password" id="currentPassword" required>
          </div>
          
          <div class="form-group">
            <label for="newPassword">ìƒˆ ë¹„ë°€ë²ˆí˜¸ * (8ì ì´ìƒ)</label>
            <input type="password" id="newPassword" required minlength="8">
          </div>
          
          <div class="form-group">
            <label for="confirmPassword">ìƒˆ ë¹„ë°€ë²ˆí˜¸ í™•ì¸ *</label>
            <input type="password" id="confirmPassword" required minlength="8">
          </div>
          
          <div style="text-align: center; margin-top: 2rem;">
            <button type="submit" class="btn btn-primary">
              ğŸ”„ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- ğŸ”§ ê´€ë¦¬ì ë©”ë‰´ í˜ì´ì§€ -->
    <? if (user.isAdmin) { ?>
    <!-- ğŸ”§ ê´€ë¦¬ì ë©”ë‰´ í˜ì´ì§€ (ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ - ì‚¬ì´ë“œë°”ë¡œ ì´ë™) -->
    <!--
    <div id="adminMenuPage" class="page">
      <div class="page-header">
        <h1 class="page-title">ğŸ”§ ê´€ë¦¬ì ë©”ë‰´</h1>
        <p class="page-subtitle">ì‹œìŠ¤í…œ ê´€ë¦¬ ë° ì„¤ì •ì„ ë³€ê²½í•˜ì„¸ìš”.</p>
      </div>
      
      <div class="dashboard-grid">
        <div class="dashboard-card" onclick="showPage('employeeManagement')" style="cursor: pointer;">
          <div class="card-icon">ğŸ‘¥</div>
          <div class="card-value">ì§ì› ê´€ë¦¬</div>
          <div class="card-label">ì§ì› ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ</div>
        </div>
        
        <div class="dashboard-card" onclick="showPage('departmentManagement')" style="cursor: pointer;">
          <div class="card-icon">ğŸ¢</div>
          <div class="card-value">ë¶€ì„œ ê´€ë¦¬</div>
          <div class="card-label">ë¶€ì„œ ì¶”ê°€/ìˆ˜ì •/ì‚­ì œ</div>
        </div>
        
        <div class="dashboard-card" onclick="showPage('systemSettings')" style="cursor: pointer;">
          <div class="card-icon">âš™ï¸</div>
          <div class="card-value">ì‹œìŠ¤í…œ ì„¤ì •</div>
          <div class="card-label">ì—°ì°¨ ì •ì±… ë° ì„¤ì •</div>
        </div>
        
        <div class="dashboard-card" onclick="showPage('statistics')" style="cursor: pointer;">
          <div class="card-icon">ğŸ“ˆ</div>
          <div class="card-value">í†µê³„ ë° ë°±ì—…</div>
          <div class="card-label">ë°ì´í„° ë¶„ì„ ë° ë°±ì—…</div>
        </div>
      </div>
    </div>
    -->

    <!-- ğŸ‘¥ ì§ì› ê´€ë¦¬ í˜ì´ì§€ -->
    <div id="employeeManagementPage" class="page">
      <div class="page-header">
        <h1 class="page-title">ğŸ‘¥ ì§ì› ê´€ë¦¬</h1>
        <p class="page-subtitle">ì§ì› ì •ë³´ë¥¼ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      </div>
      
      <!-- ì§ì› ì¶”ê°€ ì„¹ì…˜ -->
      <div class="employee-form-section">
        <div class="section-header">
          <h3 class="section-title">ğŸ“ ì§ì› ì¶”ê°€</h3>
        </div>
        
        <div class="form-container">
          <div class="info-banner">
            <div class="info-icon">ğŸ“‹</div>
            <div class="info-content">
              <strong>ìë™ ìƒì„± ì •ë³´</strong>
              <ul class="info-list">
                <li>ì‚¬ë²ˆ: ì‹œìŠ¤í…œì—ì„œ ìë™ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ (ê¸°ì¡´ ìµœëŒ€ ì‚¬ë²ˆ + 1)</li>
                <li>ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸: <code>temp123</code> (ì²« ë¡œê·¸ì¸ ì‹œ ë³€ê²½ í•„ìš”)</li>
              </ul>
            </div>
          </div>
          
          <form id="addEmployeeForm" onsubmit="addEmployee(event)">
            <div class="form-grid">
              <div class="form-group">
                <label for="empName">ì´ë¦„ *</label>
                <input type="text" id="empName" required placeholder="í™ê¸¸ë™">
              </div>
              
              <div class="form-group">
                <label for="empEmail">ì´ë©”ì¼ *</label>
                <input type="email" id="empEmail" required placeholder="hong@company.com">
              </div>
              
              <div class="form-group">
                <label for="empPhone">ì „í™”ë²ˆí˜¸</label>
                <input type="tel" id="empPhone" placeholder="010-1234-5678">
              </div>
              
              <div class="form-group">
                <label for="empDept">ë¶€ì„œ *</label>
                <select id="empDept" required>
                  <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                  <option value="10">ê°œë°œíŒ€</option>
                  <option value="20">ì˜ì—…íŒ€</option>
                  <option value="30">ì¸ì‚¬íŒ€</option>
                  <option value="40">ì´ë¬´íŒ€</option>
                </select>
              </div>
              
              <div class="form-group">
                <label for="empPosition">ì§ê¸‰</label>
                <input type="text" id="empPosition" placeholder="ì˜ˆ: ëŒ€ë¦¬">
              </div>
            </div>
            
            <div class="form-actions">
              <button type="submit" class="btn btn-primary btn-large">
                <span class="btn-icon">ğŸ‘¥</span>
                <span class="btn-text">ì§ì› ì¶”ê°€</span>
              </button>
            </div>
          </form>
        </div>
      </div>
      
      <!-- ì§ì› ëª©ë¡ ì„¹ì…˜ -->
      <div class="employee-list-section">
        <div class="section-header">
          <h3 class="section-title">ğŸ“‹ ì§ì› ëª©ë¡</h3>
          <div class="search-controls">
            <div class="search-input-wrapper">
              <input 
                type="text" 
                id="employeeSearchInput" 
                placeholder="ğŸ” ì´ë¦„, ì´ë©”ì¼, ë¶€ì„œë¡œ ê²€ìƒ‰..." 
                class="search-input"
                onkeyup="searchEmployees()"
                onkeydown="if(event.key==='Enter'){event.preventDefault();searchEmployees();}"
              />
            </div>
            <button 
              type="button" 
              class="btn btn-secondary btn-reset" 
              onclick="clearEmployeeSearch()"
            >
              <span class="btn-icon">ğŸ”„</span>
              <span class="btn-text">ì´ˆê¸°í™”</span>
            </button>
          </div>
        </div>
        
        <div class="table-container">
          <table class="table employee-table">
            <thead>
              <tr>
                <th class="col-empid">ì‚¬ë²ˆ</th>
                <th class="col-name">ì´ë¦„</th>
                <th class="col-email">ì´ë©”ì¼</th>
                <th class="col-dept">ë¶€ì„œ</th>
                <th class="col-position">ì§ê¸‰</th>
                <th class="col-actions">ê´€ë¦¬</th>
              </tr>
            </thead>
            <tbody id="employeeListTable">
              <tr>
                <td colspan="6" class="loading-cell">ì§ì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤</td>
              </tr>
            </tbody>
          </table>
        </div>
        
        <!-- ğŸ“„ í˜ì´ì§€ë„¤ì´ì…˜ -->
        <div id="employeePagination" class="pagination-container" style="display: none;">
          <div class="pagination-info">
            <span id="paginationInfo">1-10 of 0 ì§ì›</span>
          </div>
          
          <div class="pagination-controls">
            <button class="pagination-btn" id="firstPageBtn" onclick="goToPage(1)" title="ì²« í˜ì´ì§€">
              â®ï¸
            </button>
            <button class="pagination-btn" id="prevPageBtn" onclick="goToPage(currentPage - 1)" title="ì´ì „ í˜ì´ì§€">
              â—€ï¸
            </button>
            
            <div id="pageNumbers">
              <!-- í˜ì´ì§€ ë²ˆí˜¸ë“¤ì´ ì—¬ê¸°ì— ë™ì ìœ¼ë¡œ ìƒì„±ë©ë‹ˆë‹¤ -->
            </div>
            
            <button class="pagination-btn" id="nextPageBtn" onclick="goToPage(currentPage + 1)" title="ë‹¤ìŒ í˜ì´ì§€">
              â–¶ï¸
            </button>
            <button class="pagination-btn" id="lastPageBtn" onclick="goToPage(totalPages)" title="ë§ˆì§€ë§‰ í˜ì´ì§€">
              â­ï¸
            </button>
          </div>
          
          <div class="pagination-settings">
            <label for="itemsPerPage">í˜ì´ì§€ë‹¹:</label>
            <select id="itemsPerPage" class="pagination-select" onchange="changeItemsPerPage()">
              <option value="10">10ê°œ</option>
              <option value="20">20ê°œ</option>
              <option value="50">50ê°œ</option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- ğŸ¢ ë¶€ì„œ ê´€ë¦¬ í˜ì´ì§€ -->
    <div id="departmentManagementPage" class="page">
      <div class="page-header">
        <h1 class="page-title">ğŸ¢ ë¶€ì„œ ê´€ë¦¬</h1>
        <p class="page-subtitle">ë¶€ì„œ ì •ë³´ë¥¼ ì¶”ê°€, ìˆ˜ì •, ì‚­ì œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
      </div>
      
      <div class="form-container">
        <h3>ğŸ“ ë¶€ì„œ ì¶”ê°€</h3>
        <form id="addDepartmentForm" onsubmit="addDepartment(event)">
          <div class="form-grid">
            <div class="form-group">
              <label for="deptId">ë¶€ì„œì½”ë“œ *</label>
              <input type="number" id="deptId" required placeholder="ì˜ˆ: 50">
            </div>
            
            <div class="form-group">
              <label for="deptName">ë¶€ì„œëª… *</label>
              <input type="text" id="deptName" required placeholder="ì˜ˆ: ë§ˆì¼€íŒ…íŒ€">
            </div>
          </div>
          
          <div style="text-align: center; margin-top: 2rem;">
            <button type="submit" class="btn btn-primary">
              ğŸ¢ ë¶€ì„œ ì¶”ê°€
            </button>
          </div>
        </form>
      </div>
      
      <div class="table-container" style="margin-top: 3rem;">
        <h3>ğŸ“‹ ë¶€ì„œ ëª©ë¡</h3>
        <table class="table">
          <thead>
            <tr>
              <th>ë¶€ì„œì½”ë“œ</th>
              <th>ë¶€ì„œëª…</th>
              <th>ì†Œì† ì§ì› ìˆ˜</th>
              <th>ê´€ë¦¬</th>
            </tr>
          </thead>
          <tbody id="departmentListTable">
            <tr>
              <td colspan="4" class="loading">ë¶€ì„œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì • í˜ì´ì§€ -->
    <div id="systemSettingsPage" class="page">
      <div class="page-header">
        <h1 class="page-title">âš™ï¸ ì„¤ì •</h1>
        <p class="page-subtitle">ì—°ì°¨ ì •ì±… ë° ì‹œìŠ¤í…œ ì„¤ì •ì„ ê´€ë¦¬í•©ë‹ˆë‹¤.</p>
      </div>
      
      <div class="form-container">
        <h3>ğŸ“‹ ì—°ì°¨ ì •ì±… ì„¤ì •</h3>
        <form id="systemSettingsForm" onsubmit="updateSystemSettings(event)">
          <div class="form-grid">
            <div class="form-group">
              <label for="basicLeaves">ê¸°ë³¸ ì—°ì°¨ ì¼ìˆ˜</label>
              <input type="number" id="basicLeaves" value="15" min="10" max="30">
            </div>
            
            <div class="form-group">
              <label for="maxLeaves">ìµœëŒ€ ì—°ì°¨ ì¼ìˆ˜</label>
              <input type="number" id="maxLeaves" value="25" min="15" max="50">
            </div>
            
            <div class="form-group">
              <label for="sessionTimeout">ì„¸ì…˜ íƒ€ì„ì•„ì›ƒ (ë¶„)</label>
              <input type="number" id="sessionTimeout" value="120" min="30" max="480">
            </div>
            
            <div class="form-group">
              <label for="leavePolicy">ì—°ì°¨ ë°œìƒ ê¸°ì¤€</label>
              <select id="leavePolicy">
                <option value="ì…ì‚¬ì¼ ê¸°ì¤€">ì…ì‚¬ì¼ ê¸°ì¤€</option>
                <option value="íšŒê³„ì—°ë„ ê¸°ì¤€">íšŒê³„ì—°ë„ ê¸°ì¤€</option>
              </select>
            </div>
          </div>
          
          <div style="text-align: center; margin-top: 2rem;">
            <button type="submit" class="btn btn-primary">
              âš™ï¸ ì„¤ì • ì €ì¥
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- ğŸ“ˆ í†µê³„ ë° ë°±ì—… í˜ì´ì§€ -->
    <div id="statisticsPage" class="page">
      <div class="page-header">
        <h1 class="page-title">ğŸ“ˆ í†µê³„ ë° ë³´ê³ ì„œ</h1>
        <p class="page-subtitle">ì‹œìŠ¤í…œ í†µê³„ë¥¼ í™•ì¸í•˜ê³  ë°ì´í„°ë¥¼ ë°±ì—…í•©ë‹ˆë‹¤.</p>
      </div>
      
      <div class="dashboard-grid">
        <div class="dashboard-card">
          <div class="card-icon">ğŸ‘¥</div>
          <div class="card-value" id="totalEmployees">-</div>
          <div class="card-label">ì „ì²´ ì§ì› ìˆ˜</div>
        </div>
        
        <div class="dashboard-card">
          <div class="card-icon">ğŸ“</div>
          <div class="card-value" id="totalRequests">-</div>
          <div class="card-label">ì´ ì‹ ì²­ ê±´ìˆ˜</div>
        </div>
        
        <div class="dashboard-card">
          <div class="card-icon">âœ…</div>
          <div class="card-value" id="approvedRequests">-</div>
          <div class="card-label">ìŠ¹ì¸ëœ ì‹ ì²­</div>
        </div>
        
        <div class="dashboard-card">
          <div class="card-icon">ğŸ“Š</div>
          <div class="card-value" id="totalLeaveDays">-</div>
          <div class="card-label">ì´ ì‚¬ìš© ì—°ì°¨</div>
        </div>
      </div>
      
      <div class="form-container" style="margin-top: 3rem;">
        <h3>ğŸ’¾ ë°ì´í„° ë°±ì—…</h3>
        <div style="text-align: center;">
          <button type="button" class="btn btn-secondary" onclick="exportData()">
            ğŸ“¥ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
          </button>
          <button type="button" class="btn btn-primary" onclick="backupData()" style="margin-left: 1rem;">
            ğŸ’¾ ë°±ì—… ìƒì„±
          </button>
        </div>
      </div>
    </div>
    <? } ?>

  </main>

  <!-- ğŸ”§ ì§ì› ìˆ˜ì • ëª¨ë‹¬ -->
  <div id="editEmployeeModal" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <h3 class="modal-title">âœï¸ ì§ì› ì •ë³´ ìˆ˜ì •</h3>
        <button class="modal-close" onclick="closeEditEmployeeModal()">Ã—</button>
      </div>
      
      <div class="modal-body">
        <form id="editEmployeeForm">
          <div class="form-row">
            <div class="form-col">
              <div class="form-group-modal">
                <label for="editEmpId">ì‚¬ë²ˆ</label>
                <input type="text" id="editEmpId" readonly>
              </div>
            </div>
            <div class="form-col">
              <div class="form-group-modal">
                <label for="editEmpName">ì´ë¦„ *</label>
                <input type="text" id="editEmpName" required>
              </div>
            </div>
          </div>
          
          <div class="form-group-modal">
            <label for="editEmpEmail">ì´ë©”ì¼ *</label>
            <input type="email" id="editEmpEmail" required>
          </div>
          
          <div class="form-group-modal">
            <label for="editEmpPhone">ì „í™”ë²ˆí˜¸</label>
            <input type="tel" id="editEmpPhone" placeholder="010-1234-5678">
          </div>
          
          <div class="form-row">
            <div class="form-col">
              <div class="form-group-modal">
                <label for="editEmpDept">ë¶€ì„œ *</label>
                <select id="editEmpDept" required>
                  <option value="">ì„ íƒí•˜ì„¸ìš”</option>
                  <!-- ë¶€ì„œ ì˜µì…˜ë“¤ì´ JavaScriptë¡œ ë™ì  ë¡œë“œë©ë‹ˆë‹¤ -->
                </select>
              </div>
            </div>
            <div class="form-col">
              <div class="form-group-modal">
                <label for="editEmpPosition">ì§ê¸‰</label>
                <input type="text" id="editEmpPosition" placeholder="ì˜ˆ: ëŒ€ë¦¬">
              </div>
            </div>
          </div>
          
          <div class="checkbox-group">
            <input type="checkbox" id="resetPasswordCheckbox">
            <label for="resetPasswordCheckbox">ğŸ”‘ ë¹„ë°€ë²ˆí˜¸ë¥¼ temp123ìœ¼ë¡œ ì´ˆê¸°í™”</label>
          </div>
          
          <div id="editEmployeeMessage" class="alert" style="display: none; margin-top: 1rem;"></div>
        </form>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn-modal btn-modal-secondary" onclick="closeEditEmployeeModal()">
          <span>ğŸš«</span> ì·¨ì†Œ
        </button>
        <button type="button" class="btn-modal btn-modal-primary" onclick="saveEmployeeChanges()">
          <span>ğŸ’¾</span> ì €ì¥
        </button>
      </div>
    </div>
  </div>

  <!-- ğŸ¢ ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ -->
  <div id="editDepartmentModal" class="modal-overlay">
    <div class="modal-container">
      <div class="modal-header">
        <h3 class="modal-title">ğŸ¢ ë¶€ì„œ ì •ë³´ ìˆ˜ì •</h3>
        <button class="modal-close" onclick="closeEditDepartmentModal()">Ã—</button>
      </div>
      
      <div class="modal-body">
        <form id="editDepartmentForm">
          <div class="form-group-modal">
            <label for="editDeptId">ë¶€ì„œì½”ë“œ</label>
            <input type="text" id="editDeptId" readonly>
          </div>
          
          <div class="form-group-modal">
            <label for="editDeptName">ë¶€ì„œëª… *</label>
            <input type="text" id="editDeptName" required placeholder="ì˜ˆ: ë§ˆì¼€íŒ…íŒ€">
          </div>
          
          <div class="info-banner" style="margin-top: 1rem;">
            <div class="info-icon">â„¹ï¸</div>
            <div class="info-content">
              <strong>ë¶€ì„œ ìˆ˜ì • ì•ˆë‚´</strong>
              <ul class="info-list">
                <li>ë¶€ì„œì½”ë“œëŠ” ë³€ê²½í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤ (ì‹œìŠ¤í…œ ë¬´ê²°ì„± ë³´ì¥)</li>
                <li>ë¶€ì„œëª…ì€ ë‹¤ë¥¸ ë¶€ì„œì™€ ì¤‘ë³µë  ìˆ˜ ì—†ìŠµë‹ˆë‹¤</li>
                <li>ì†Œì† ì§ì›ë“¤ì—ê²Œ ìë™ìœ¼ë¡œ ë³€ê²½ì‚¬í•­ì´ ë°˜ì˜ë©ë‹ˆë‹¤</li>
              </ul>
            </div>
          </div>
          
          <div id="editDepartmentMessage" class="alert" style="display: none; margin-top: 1rem;"></div>
        </form>
      </div>
      
      <div class="modal-footer">
        <button type="button" class="btn-modal btn-modal-secondary" onclick="closeEditDepartmentModal()">
          <span>ğŸš«</span> ì·¨ì†Œ
        </button>
        <button type="button" class="btn-modal btn-modal-primary" onclick="saveDepartmentChanges()">
          <span>ğŸ’¾</span> ì €ì¥
        </button>
      </div>
    </div>
  </div>

  <!-- ì‚¬ìš©ì ì •ë³´ë¥¼ JavaScriptì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ìˆ¨ê²¨ì§„ ìš”ì†Œë¡œ ì „ë‹¬ -->
  <div id="userInfo" style="display: none;">
    <span id="userEmpId"><?= typeof user !== 'undefined' && user.empId ? user.empId : 'UNKNOWN' ?></span>
    <span id="userName"><?= typeof user !== 'undefined' && user.name ? user.name : 'ì‚¬ìš©ì' ?></span>
    <span id="userEmail"><?= typeof user !== 'undefined' && user.email ? user.email : 'unknown@company.com' ?></span>
    <span id="userPosition"><?= typeof user !== 'undefined' && user.position ? user.position : 'ì§ì›' ?></span>
    <span id="userIsAdmin"><?= typeof user !== 'undefined' && user.isAdmin ? user.isAdmin : false ?></span>
    <span id="userDepartment"><?= typeof user !== 'undefined' && user.department ? user.department : 'ë¯¸ì§€ì •' ?></span>
  </div>
  


  <!-- ğŸ”§ JavaScript -->
  <script>
    // ğŸ“š ì „ì—­ ë³€ìˆ˜ (ìˆ¨ê²¨ì§„ HTML ìš”ì†Œì—ì„œ ê°€ì ¸ì˜´)
    var currentUser = {};
    var allEmployees = []; // ì „ì—­ ì§ì› ëª©ë¡ ì €ì¥
    
    // ğŸ“„ í˜ì´ì§€ë„¤ì´ì…˜ ì „ì—­ ë³€ìˆ˜
    var currentPage = 1;
    var itemsPerPage = 10;
    var totalPages = 1;
    var filteredEmployees = []; // ê²€ìƒ‰ í•„í„°ë§ëœ ì§ì› ëª©ë¡
    
    // ì•ˆì „í•œ ì‚¬ìš©ì ì •ë³´ ë¡œë“œ
    try {
      const userEmpIdEl = document.getElementById('userEmpId');
      const userNameEl = document.getElementById('userName');
      const userEmailEl = document.getElementById('userEmail');
      const userPositionEl = document.getElementById('userPosition');
      const userIsAdminEl = document.getElementById('userIsAdmin');
      
      if (userEmpIdEl && userNameEl && userEmailEl && userPositionEl && userIsAdminEl) {
        currentUser = {
          empId: userEmpIdEl.textContent || 'UNKNOWN',
          name: userNameEl.textContent || 'ì‚¬ìš©ì',
          email: userEmailEl.textContent || 'unknown@company.com',
          position: userPositionEl.textContent || 'ì§ì›',
          isAdmin: userIsAdminEl.textContent === 'true'
        };
        console.log('âœ… ì‚¬ìš©ì ì •ë³´ ë¡œë“œ ì„±ê³µ:', currentUser);
      } else {
        console.error('âŒ ì‚¬ìš©ì ì •ë³´ ìš”ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤');
        currentUser = {
          empId: 'ERROR',
          name: 'ì˜¤ë¥˜',
          email: 'error@company.com',
          position: 'ì˜¤ë¥˜',
          isAdmin: false
        };
      }
    } catch (error) {
      console.error('âŒ ì‚¬ìš©ì ì •ë³´ ë¡œë“œ ì˜¤ë¥˜:', error);
      currentUser = {
        empId: 'ERROR',
        name: 'ì˜¤ë¥˜',
        email: 'error@company.com',
        position: 'ì˜¤ë¥˜',
        isAdmin: false
      };
    }
    
    var selectedApprovers = [];
    var selectedCollaborators = [];
    
    /**
     * ğŸš€ í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
     */
    window.addEventListener('load', function() {
      try {
        // ì‚¬ìš©ì ì •ë³´ ìœ íš¨ì„± ê²€ì‚¬
        if (currentUser.empId === 'ERROR' || currentUser.empId === 'UNKNOWN') {
          showErrorMessage('ì‚¬ìš©ì ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•˜ê±°ë‚˜ ë‹¤ì‹œ ë¡œê·¸ì¸í•´ì£¼ì„¸ìš”.');
          return;
        }
        
        // ê¸°ë³¸ UI ì´ˆê¸°í™”
        initializeUI();
        
        // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ (ë¹„ë™ê¸°)
        setTimeout(() => {
          loadDashboardData();
          updateNotificationBadge();
        }, 100);
      } catch (error) {
        console.error('âŒ ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì˜¤ë¥˜:', error);
        showErrorMessage('ì‹œìŠ¤í…œ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
      }
    });
    

    
    /**
     * ğŸ¨ UI ì´ˆê¸°í™”
     */
    function initializeUI() {
      // ì‚¬ìš©ìëª… í‘œì‹œ í™•ì¸
      const userButtons = document.querySelectorAll('.user-button');
      userButtons.forEach(button => {
        if (button.textContent.includes('<?= user.name ?>')) {
          button.innerHTML = `ğŸ‘¤ ${currentUser.name} <span style="margin-left: 0.5rem;">â–¼</span>`;
        }
      });
      
      // ëŒ€ì‹œë³´ë“œ ì¸ì‚¬ë§ ì—…ë°ì´íŠ¸
      const subtitle = document.querySelector('.page-subtitle');
      if (subtitle && subtitle.textContent.includes('<?= user.name ?>')) {
        subtitle.textContent = `ì•ˆë…•í•˜ì„¸ìš”, ${currentUser.name}ë‹˜! ì—°ì°¨ í˜„í™©ì„ í™•ì¸í•´ë³´ì„¸ìš”.`;
      }
      
      console.log('âœ… UI ì´ˆê¸°í™” ì™„ë£Œ');
    }
    
    /**
     * âŒ ì˜¤ë¥˜ ë©”ì‹œì§€ í‘œì‹œ
     */
    function showErrorMessage(message) {
      const errorDiv = document.createElement('div');
      errorDiv.style.cssText = 'position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: #f8d7da; color: #721c24; padding: 1rem; border-radius: 5px; z-index: 9999; border: 1px solid #f5c6cb;';
      errorDiv.textContent = message;
      document.body.appendChild(errorDiv);
      
      setTimeout(() => {
        document.body.removeChild(errorDiv);
      }, 5000);
    }
    
    /**
     * ğŸ“„ í˜ì´ì§€ ì „í™˜ í•¨ìˆ˜
     */
    function showPage(pageId) {
      // userManagementë¥¼ employeeManagementë¡œ ë¦¬ë‹¤ì´ë ‰íŠ¸ (í˜¸í™˜ì„±)
      if (pageId === 'userManagement') {
        pageId = 'employeeManagement';
      }
      
      // ëª¨ë“  í˜ì´ì§€ ìˆ¨ê¹€
      document.querySelectorAll('.page').forEach(page => {
        page.classList.remove('active');
      });
      
      // ëª¨ë“  ë©”ë‰´ ë¹„í™œì„±í™”
      document.querySelectorAll('.menu-item').forEach(item => {
        item.classList.remove('active');
      });
      
      // ì„ íƒëœ í˜ì´ì§€ í‘œì‹œ
      const targetPage = document.getElementById(pageId + 'Page');
      if (targetPage) {
        targetPage.classList.add('active');
      }
      
      // í•´ë‹¹ ë©”ë‰´ í™œì„±í™”
      document.querySelectorAll('.menu-item').forEach(item => {
        if (item.textContent.includes(getPageTitle(pageId)) || 
            (pageId === 'employeeManagement' && item.textContent.includes('ì§ì› ê´€ë¦¬'))) {
          item.classList.add('active');
        }
      });
      
      // í˜ì´ì§€ë³„ ë°ì´í„° ë¡œë“œ
      loadPageData(pageId);
      
      // ì‚¬ìš©ì ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
      hideUserMenu();
    }
    
    /**
     * ğŸ·ï¸ í˜ì´ì§€ ì œëª© ë§¤í•‘
     */
    function getPageTitle(pageId) {
      const titles = {
        'dashboard': 'ëŒ€ì‹œë³´ë“œ',
        'leaveRequest': 'ì—°ì°¨ ì‹ ì²­',
        'myRequests': 'ë‚´ ì‹ ì²­ í˜„í™©',
        'approvals': 'ê²°ì¬/í˜‘ì¡° ì²˜ë¦¬',
        'myInfo': 'ë‚´ ì •ë³´',
        'changePassword': 'ë¹„ë°€ë²ˆí˜¸ ë³€ê²½',
        'adminMenu': 'ê´€ë¦¬ì ë©”ë‰´',
        'employeeManagement': 'ì§ì› ê´€ë¦¬',
        'userManagement': 'ì§ì› ê´€ë¦¬', // ê´€ë¦¬ì ë©”ë‰´ìš© ë³„ì¹­
        'departmentManagement': 'ë¶€ì„œ ê´€ë¦¬',
        'systemSettings': 'ì„¤ì •',
        'statistics': 'í†µê³„ ë° ë³´ê³ ì„œ'
      };
      return titles[pageId] || '';
    }
    
    /**
     * ğŸ“Š ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
     */
    async function loadDashboardData() {
      try {
        console.log('ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì¤‘...');
        
        if (currentUser.isAdmin) {
          // ê´€ë¦¬ììš© ì‹œìŠ¤í…œ í˜„í™© ë°ì´í„° ë¡œë“œ
          const systemStats = await callServerFunction('getSystemStatistics');
          const departments = await callServerFunction('getAllDepartments');
          
          if (systemStats) {
            document.getElementById('totalEmployees').textContent = systemStats.totalEmployees || '0';
            document.getElementById('totalRequests').textContent = systemStats.totalRequests || '0';
            document.getElementById('approvedRequests').textContent = systemStats.approvedRequests || '0';
            document.getElementById('totalDepartments').textContent = departments ? departments.length : '0';
          }
        } else {
          // ì§ì›ìš© ê°œì¸ ì—°ì°¨ ë°ì´í„° ë¡œë“œ
          const dashboardData = await callServerFunction('getDashboardData', currentUser.empId);
          
          if (dashboardData) {
            document.getElementById('remainingLeaves').textContent = dashboardData.remainingLeaves || '15';
            document.getElementById('pendingRequests').textContent = dashboardData.pendingRequests || '0';
            document.getElementById('pendingApprovals').textContent = dashboardData.pendingApprovals || '0';
            document.getElementById('thisMonthUsed').textContent = dashboardData.thisMonthUsed || '0';
            
            // ìµœê·¼ ì‹ ì²­ ë‚´ì—­ ë¡œë“œ
            loadRecentRequests();
          }
        }
        
      } catch (error) {
        console.error('ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
        // ê¸°ë³¸ê°’ ì„¤ì •
        if (currentUser.isAdmin) {
          if (document.getElementById('totalEmployees')) document.getElementById('totalEmployees').textContent = '0';
          if (document.getElementById('totalRequests')) document.getElementById('totalRequests').textContent = '0';
          if (document.getElementById('approvedRequests')) document.getElementById('approvedRequests').textContent = '0';
          if (document.getElementById('totalDepartments')) document.getElementById('totalDepartments').textContent = '0';
        } else {
          if (document.getElementById('remainingLeaves')) document.getElementById('remainingLeaves').textContent = '15';
          if (document.getElementById('pendingRequests')) document.getElementById('pendingRequests').textContent = '0';
          if (document.getElementById('pendingApprovals')) document.getElementById('pendingApprovals').textContent = '0';
          if (document.getElementById('thisMonthUsed')) document.getElementById('thisMonthUsed').textContent = '0';
        }
      }
    }
    
    /**
     * ğŸ“ ìµœê·¼ ì‹ ì²­ ë‚´ì—­ ë¡œë“œ
     */
    async function loadRecentRequests() {
      try {
        const recentRequests = await callServerFunction('getRecentRequests', currentUser.empId);
        const tableBody = document.getElementById('recentRequestsTable');
        
        if (recentRequests && recentRequests.length > 0) {
          tableBody.innerHTML = recentRequests.map(request => `
            <tr>
              <td>${formatDate(request.submitDate)}</td>
              <td>${request.leaveType}</td>
              <td>${formatDate(request.startDate)} ~ ${formatDate(request.endDate)}</td>
              <td><span class="status-badge status-${getStatusClass(request.status)}">${request.status}</span></td>
              <td>${request.reason}</td>
            </tr>
          `).join('');
        } else {
          tableBody.innerHTML = '<tr><td colspan="5" style="text-align: center; color: #666;">ìµœê·¼ ì‹ ì²­ ë‚´ì—­ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        }
        
      } catch (error) {
        console.error('ìµœê·¼ ì‹ ì²­ ë‚´ì—­ ë¡œë“œ ì˜¤ë¥˜:', error);
        document.getElementById('recentRequestsTable').innerHTML = 
          '<tr><td colspan="5" style="text-align: center; color: #dc3545;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
      }
    }
    
    /**
     * ğŸ“„ í˜ì´ì§€ë³„ ë°ì´í„° ë¡œë“œ
     */
    function loadPageData(pageId) {
      switch (pageId) {
        case 'dashboard':
          loadDashboardData();
          break;
        case 'myRequests':
          loadMyRequests();
          break;
        case 'approvals':
          loadApprovals();
          break;
        case 'myInfo':
          loadMyInfo();
          break;
        case 'leaveRequest':
          initializeLeaveRequestForm();
          break;
        case 'employeeManagement':
        case 'userManagement': // í˜¸í™˜ì„±ì„ ìœ„í•œ ë³„ì¹­
          loadEmployeeManagement();
          break;
        case 'departmentManagement':
          loadDepartmentManagement();
          break;
        case 'systemSettings':
          loadSystemSettings();
          break;
        case 'statistics':
          loadStatistics();
          break;
      }
    }
    
    /**
     * ğŸ“ ì„œë²„ í•¨ìˆ˜ í˜¸ì¶œ í—¬í¼
     */
    function callServerFunction(functionName, ...args) {
      return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler(resolve)
          .withFailureHandler(reject)
          [functionName](...args);
      });
    }
    
    /**
     * ğŸ“… ë‚ ì§œ í¬ë§·íŒ…
     */
    function formatDate(dateString) {
      if (!dateString) return '-';
      const date = new Date(dateString);
      return date.toLocaleDateString('ko-KR');
    }
    
    /**
     * ğŸ·ï¸ ìƒíƒœë³„ CSS í´ë˜ìŠ¤
     */
    function getStatusClass(status) {
      switch (status) {
        case 'ëŒ€ê¸°': return 'pending';
        case 'ìŠ¹ì¸': return 'approved';
        case 'ë°˜ë ¤': return 'rejected';
        default: return 'pending';
      }
    }
    
    /**
     * ğŸ‘¤ ì‚¬ìš©ì ë©”ë‰´ í† ê¸€
     */
    function toggleUserMenu() {
      const dropdown = document.getElementById('userDropdown');
      const isVisible = dropdown.style.display === 'block';
      dropdown.style.display = isVisible ? 'none' : 'block';
    }
    
    /**
     * ğŸ™ˆ ì‚¬ìš©ì ë©”ë‰´ ìˆ¨ê¹€
     */
    function hideUserMenu() {
      document.getElementById('userDropdown').style.display = 'none';
    }
    
    /**
     * ğŸ”” ì•Œë¦¼ í‘œì‹œ
     */
    function showNotifications() {
      alert('ì•Œë¦¼ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
    }
    
    /**
     * ğŸ“ ì—°ì°¨ ì‹ ì²­ í¼ ì´ˆê¸°í™”
     */
    function initializeLeaveRequestForm() {
      // ì˜¤ëŠ˜ ë‚ ì§œë¥¼ ê¸°ë³¸ê°’ìœ¼ë¡œ ì„¤ì •
      const today = new Date().toISOString().split('T')[0];
      document.getElementById('startDate').value = today;
      document.getElementById('endDate').value = today;
      
      // ì„ íƒëœ ê²°ì¬ì/í˜‘ì¡°ì ì´ˆê¸°í™”
      selectedApprovers = [];
      selectedCollaborators = [];
      updateSelectedApprovers();
      updateSelectedCollaborators();
    }
    
    /**
     * ğŸ“… ì—°ì°¨ ì¼ìˆ˜ ìë™ ê³„ì‚°
     */
    function calculateLeaveDays() {
      const startDate = document.getElementById('startDate').value;
      const endDate = document.getElementById('endDate').value;
      const leaveType = document.getElementById('leaveType').value;
      
      if (startDate && endDate && leaveType) {
        const days = calculateDays(startDate, endDate, leaveType);
        document.getElementById('calculatedDays').value = days + 'ì¼';
      } else {
        document.getElementById('calculatedDays').value = '';
      }
    }
    
    /**
     * ğŸ“ ì—°ì°¨ ì‹ ì²­ ì œì¶œ
     */
    async function submitLeaveRequest(event) {
      event.preventDefault();
      
      if (selectedApprovers.length === 0) {
        alert('ê²°ì¬ìë¥¼ ìµœì†Œ 1ëª… ì´ìƒ ì„ íƒí•´ì£¼ì„¸ìš”.');
        return;
      }
      
      const formData = {
        startDate: document.getElementById('startDate').value,
        endDate: document.getElementById('endDate').value,
        leaveType: document.getElementById('leaveType').value,
        reason: document.getElementById('reason').value,
        approvers: selectedApprovers,
        collaborators: selectedCollaborators
      };
      
      try {
        showLoading(true);
        const result = await callServerFunction('submitLeaveRequest', formData);
        
        if (result.success) {
          showNotification('ì—°ì°¨ ì‹ ì²­ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
          document.getElementById('leaveRequestForm').reset();
          selectedApprovers = [];
          selectedCollaborators = [];
          updateSelectedApprovers();
          updateSelectedCollaborators();
          showPage('myRequests');
        } else {
          showNotification('ì—°ì°¨ ì‹ ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + result.error, 'error');
        }
      } catch (error) {
        console.error('ì—°ì°¨ ì‹ ì²­ ì˜¤ë¥˜:', error);
        showNotification('ì—°ì°¨ ì‹ ì²­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }
    
    /**
     * ğŸ‘¥ ê²°ì¬ì ì„ íƒ ëª¨ë‹¬ ì—´ê¸°
     */
    function openApproverModal() {
      alert('ê²°ì¬ì ì„ íƒ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
    }
    
    /**
     * ğŸ¤ í˜‘ì¡°ì ì„ íƒ ëª¨ë‹¬ ì—´ê¸°
     */
    function openCollaboratorModal() {
      alert('í˜‘ì¡°ì ì„ íƒ ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤.');
    }
    
    /**
     * ğŸ“‹ ì„ íƒëœ ê²°ì¬ì ì—…ë°ì´íŠ¸
     */
    function updateSelectedApprovers() {
      const container = document.getElementById('selectedApprovers');
      if (selectedApprovers.length === 0) {
        container.innerHTML = '<p style="color: #666; font-style: italic;">ì„ íƒëœ ê²°ì¬ìê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
      } else {
        container.innerHTML = selectedApprovers.map((approver, index) => `
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: #f8f9fa; border-radius: 5px; margin-bottom: 0.5rem;">
            <span>${index + 1}. ${approver.name} (${approver.position})</span>
            <button type="button" onclick="removeApprover(${index})" style="background: #dc3545; color: white; border: none; border-radius: 3px; padding: 0.25rem 0.5rem; cursor: pointer;">ì œê±°</button>
          </div>
        `).join('');
      }
    }
    
    /**
     * ğŸ“‹ ì„ íƒëœ í˜‘ì¡°ì ì—…ë°ì´íŠ¸
     */
    function updateSelectedCollaborators() {
      const container = document.getElementById('selectedCollaborators');
      if (selectedCollaborators.length === 0) {
        container.innerHTML = '<p style="color: #666; font-style: italic;">ì„ íƒëœ í˜‘ì¡°ìê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
      } else {
        container.innerHTML = selectedCollaborators.map((collaborator, index) => `
          <div style="display: flex; justify-content: space-between; align-items: center; padding: 0.5rem; background: #f8f9fa; border-radius: 5px; margin-bottom: 0.5rem;">
            <span>${collaborator.name} (${collaborator.position})</span>
            <button type="button" onclick="removeCollaborator(${index})" style="background: #dc3545; color: white; border: none; border-radius: 3px; padding: 0.25rem 0.5rem; cursor: pointer;">ì œê±°</button>
          </div>
        `).join('');
      }
    }
    
    /**
     * âŒ ê²°ì¬ì ì œê±°
     */
    function removeApprover(index) {
      selectedApprovers.splice(index, 1);
      updateSelectedApprovers();
    }
    
    /**
     * âŒ í˜‘ì¡°ì ì œê±°
     */
    function removeCollaborator(index) {
      selectedCollaborators.splice(index, 1);
      updateSelectedCollaborators();
    }
    
    /**
     * ğŸ“Š ë‚´ ì‹ ì²­ í˜„í™© ë¡œë“œ
     */
    async function loadMyRequests() {
      try {
        const myRequests = await callServerFunction('getMyRequests', currentUser.empId);
        const tableBody = document.getElementById('myRequestsTable');
        
        if (myRequests && myRequests.length > 0) {
          tableBody.innerHTML = myRequests.map(request => `
            <tr>
              <td>${request.reqId}</td>
              <td>${formatDate(request.submitDate)}</td>
              <td>${request.leaveType}</td>
              <td>${formatDate(request.startDate)} ~ ${formatDate(request.endDate)}</td>
              <td>${request.days}ì¼</td>
              <td><span class="status-badge status-${getStatusClass(request.status)}">${request.status}</span></td>
              <td>${request.reason}</td>
              <td><button onclick="showApprovalStatus('${request.reqId}')" class="btn btn-secondary" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">ìƒì„¸ë³´ê¸°</button></td>
            </tr>
          `).join('');
        } else {
          tableBody.innerHTML = '<tr><td colspan="8" style="text-align: center; color: #666;">ì‹ ì²­í•œ ì—°ì°¨ê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        }
      } catch (error) {
        console.error('ë‚´ ì‹ ì²­ í˜„í™© ë¡œë“œ ì˜¤ë¥˜:', error);
        document.getElementById('myRequestsTable').innerHTML = 
          '<tr><td colspan="8" style="text-align: center; color: #dc3545;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
      }
    }
    
    /**
     * ğŸ“Š ê²°ì¬ í˜„í™© ìƒì„¸ë³´ê¸°
     */
    function showApprovalStatus(reqId) {
      alert('ê²°ì¬ í˜„í™© ìƒì„¸ë³´ê¸° ê¸°ëŠ¥ì€ ê°œë°œ ì¤‘ì…ë‹ˆë‹¤. ì‹ ì²­ID: ' + reqId);
    }
    
    /**
     * âœ… ê²°ì¬/í˜‘ì¡° ì²˜ë¦¬ ëª©ë¡ ë¡œë“œ
     */
    async function loadApprovals() {
      try {
        // ê²°ì¬ ëŒ€ê¸° ëª©ë¡
        const pendingApprovals = await callServerFunction('getPendingApprovals', currentUser.empId);
        const approvalsTable = document.getElementById('pendingApprovalsTable');
        
        if (pendingApprovals && pendingApprovals.length > 0) {
          approvalsTable.innerHTML = pendingApprovals.map(request => `
            <tr>
              <td>${request.reqId}</td>
              <td>${request.applicantName}</td>
              <td>${request.leaveType}</td>
              <td>${formatDate(request.startDate)} ~ ${formatDate(request.endDate)}</td>
              <td>${request.days}ì¼</td>
              <td>${request.reason}</td>
              <td>
                <button onclick="processApproval('${request.reqId}', 'approve')" class="btn btn-success" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-right: 0.25rem;">ìŠ¹ì¸</button>
                <button onclick="processApproval('${request.reqId}', 'reject')" class="btn btn-danger" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">ë°˜ë ¤</button>
              </td>
            </tr>
          `).join('');
        } else {
          approvalsTable.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #666;">ê²°ì¬ ëŒ€ê¸° ê±´ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        }
        
        // í˜‘ì¡° ëŒ€ê¸° ëª©ë¡
        const pendingCollaborations = await callServerFunction('getPendingCollaborations', currentUser.empId);
        const collaborationsTable = document.getElementById('pendingCollaborationsTable');
        
        if (pendingCollaborations && pendingCollaborations.length > 0) {
          collaborationsTable.innerHTML = pendingCollaborations.map(request => `
            <tr>
              <td>${request.reqId}</td>
              <td>${request.applicantName}</td>
              <td>${request.leaveType}</td>
              <td>${formatDate(request.startDate)} ~ ${formatDate(request.endDate)}</td>
              <td>${request.days}ì¼</td>
              <td>${request.reason}</td>
              <td>
                <button onclick="processCollaboration('${request.reqId}', 'approve')" class="btn btn-success" style="padding: 0.25rem 0.5rem; font-size: 0.8rem; margin-right: 0.25rem;">í˜‘ì¡°</button>
                <button onclick="processCollaboration('${request.reqId}', 'reject')" class="btn btn-danger" style="padding: 0.25rem 0.5rem; font-size: 0.8rem;">ê±°ë¶€</button>
              </td>
            </tr>
          `).join('');
        } else {
          collaborationsTable.innerHTML = '<tr><td colspan="7" style="text-align: center; color: #666;">í˜‘ì¡° ëŒ€ê¸° ê±´ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        }
        
      } catch (error) {
        console.error('ê²°ì¬/í˜‘ì¡° ëª©ë¡ ë¡œë“œ ì˜¤ë¥˜:', error);
        document.getElementById('pendingApprovalsTable').innerHTML = 
          '<tr><td colspan="7" style="text-align: center; color: #dc3545;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        document.getElementById('pendingCollaborationsTable').innerHTML = 
          '<tr><td colspan="7" style="text-align: center; color: #dc3545;">ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
      }
    }
    
    /**
     * âœ… ê²°ì¬ ì²˜ë¦¬
     */
    async function processApproval(reqId, action) {
      const comment = prompt(action === 'approve' ? 'ìŠ¹ì¸ ì˜ê²¬ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­):' : 'ë°˜ë ¤ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
      
      if (action === 'reject' && !comment) {
        alert('ë°˜ë ¤ ì‹œì—ëŠ” ì‚¬ìœ ë¥¼ ë°˜ë“œì‹œ ì…ë ¥í•´ì£¼ì„¸ìš”.');
        return;
      }
      
      try {
        showLoading(true);
        const result = await callServerFunction('processApproval', reqId, action, comment || '');
        
        if (result.success) {
          showNotification(action === 'approve' ? 'ìŠ¹ì¸ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ë°˜ë ¤ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          loadApprovals(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
          updateNotificationBadge(); // ì•Œë¦¼ ë°°ì§€ ì—…ë°ì´íŠ¸
        } else {
          showNotification('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + result.error, 'error');
        }
      } catch (error) {
        console.error('ê²°ì¬ ì²˜ë¦¬ ì˜¤ë¥˜:', error);
        showNotification('ê²°ì¬ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }
    
    /**
     * ğŸ¤ í˜‘ì¡° ì²˜ë¦¬
     */
    async function processCollaboration(reqId, action) {
      const comment = prompt(action === 'approve' ? 'í˜‘ì¡° ì˜ê²¬ì„ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­):' : 'ê±°ë¶€ ì‚¬ìœ ë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
      
      try {
        showLoading(true);
        const result = await callServerFunction('processCollaboration', reqId, action, comment || '');
        
        if (result.success) {
          showNotification(action === 'approve' ? 'í˜‘ì¡° ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.' : 'ê±°ë¶€ ì²˜ë¦¬ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          loadApprovals(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
          updateNotificationBadge(); // ì•Œë¦¼ ë°°ì§€ ì—…ë°ì´íŠ¸
        } else {
          showNotification('ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + result.error, 'error');
        }
      } catch (error) {
        console.error('í˜‘ì¡° ì²˜ë¦¬ ì˜¤ë¥˜:', error);
        showNotification('í˜‘ì¡° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }
    
    /**
     * ğŸ‘¤ ë‚´ ì •ë³´ ë¡œë“œ
     */
    async function loadMyInfo() {
      try {
        const myLeaveInfo = await callServerFunction('getMyLeaveInfo', currentUser.empId);
        const container = document.getElementById('myLeaveInfo');
        
        if (myLeaveInfo) {
          container.innerHTML = `
            <div class="dashboard-card">
              <div class="card-icon">ğŸ“…</div>
              <div class="card-value">${myLeaveInfo.totalLeaves || 15}</div>
              <div class="card-label">ì´ ì—°ì°¨ ì¼ìˆ˜</div>
            </div>
            <div class="dashboard-card">
              <div class="card-icon">âœ…</div>
              <div class="card-value">${myLeaveInfo.usedLeaves || 0}</div>
              <div class="card-label">ì‚¬ìš©í•œ ì—°ì°¨</div>
            </div>
            <div class="dashboard-card">
              <div class="card-icon">ğŸ“Š</div>
              <div class="card-value">${myLeaveInfo.remainingLeaves || 15}</div>
              <div class="card-label">ë‚¨ì€ ì—°ì°¨</div>
            </div>
            <div class="dashboard-card">
              <div class="card-icon">ğŸ“ˆ</div>
              <div class="card-value">${myLeaveInfo.thisYearUsed || 0}</div>
              <div class="card-label">ì˜¬í•´ ì‚¬ìš©</div>
            </div>
          `;
        }
      } catch (error) {
        console.error('ë‚´ ì •ë³´ ë¡œë“œ ì˜¤ë¥˜:', error);
        document.getElementById('myLeaveInfo').innerHTML = 
          '<p style="text-align: center; color: #dc3545;">ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
      }
    }
    
    /**
     * ğŸ”‘ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½
     */
    async function changePassword(event) {
      event.preventDefault();
      
      const currentPassword = document.getElementById('currentPassword').value;
      const newPassword = document.getElementById('newPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      if (newPassword !== confirmPassword) {
        alert('ìƒˆ ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
        return;
      }
      
      if (newPassword.length < 8) {
        alert('ìƒˆ ë¹„ë°€ë²ˆí˜¸ëŠ” 8ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.');
        return;
      }
      
      try {
        showLoading(true);
        const result = await callServerFunction('changePassword', currentPassword, newPassword);
        
        if (result && result.success) {
          showNotification('ë¹„ë°€ë²ˆí˜¸ê°€ ì„±ê³µì ìœ¼ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          document.getElementById('changePasswordForm').reset();
        } else {
          const errorMessage = result && result.message ? result.message : 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.';
          showNotification('ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì‹¤íŒ¨: ' + errorMessage, 'error');
        }
      } catch (error) {
        console.error('ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì˜¤ë¥˜:', error);
        showNotification('ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }
    
    /**
     * ğŸ”„ ì•Œë¦¼ ë°°ì§€ ì—…ë°ì´íŠ¸
     */
    async function updateNotificationBadge() {
      try {
        const notificationCount = await callServerFunction('getNotificationCount', currentUser.empId);
        const badge = document.getElementById('notificationBadge');
        
        if (badge) {
          if (notificationCount > 0) {
            badge.textContent = notificationCount;
            badge.style.display = 'block';
          } else {
            badge.style.display = 'none';
          }
        }
      } catch (error) {
        console.error('ì•Œë¦¼ ë°°ì§€ ì—…ë°ì´íŠ¸ ì˜¤ë¥˜:', error);
      }
    }
    
    /**
     * ğŸšª ë¡œê·¸ì•„ì›ƒ
     */
    async function logout() {
      if (confirm('ì •ë§ ë¡œê·¸ì•„ì›ƒí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        try {
          // ë¡œë”© í‘œì‹œ
          showLoading(true);
          
          const result = await callServerFunction('doLogout');
          
          if (result && result.success !== false) {
            // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
            showNotification('ë¡œê·¸ì•„ì›ƒë˜ì—ˆìŠµë‹ˆë‹¤. ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™í•©ë‹ˆë‹¤.', 'success');
            
            // ì„œë²„ì—ì„œ ë¡œê·¸ì¸ í˜ì´ì§€ HTMLì„ ì§ì ‘ ê°€ì ¸ì™€ì„œ êµì²´
            try {
              const loginPageResult = await callServerFunction('getLoginPageAfterLogout');
              
              if (loginPageResult && loginPageResult.success && loginPageResult.html) {
                // í˜„ì¬ í˜ì´ì§€ ì „ì²´ë¥¼ ë¡œê·¸ì¸ í˜ì´ì§€ HTMLë¡œ êµì²´
                document.open();
                document.write(loginPageResult.html);
                document.close();
              } else {
                throw new Error('ë¡œê·¸ì¸ í˜ì´ì§€ HTML ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨');
              }
            } catch (htmlError) {
              // HTML êµì²´ ì‹¤íŒ¨ ì‹œ URL ë¦¬ë‹¤ì´ë ‰íŠ¸ë¡œ í´ë°±
              const baseUrl = window.location.href.split('?')[0];
              window.location.replace(baseUrl + '?logout=true&t=' + new Date().getTime());
            }
            
          } else {
            throw new Error(result.message || 'ë¡œê·¸ì•„ì›ƒ ì²˜ë¦¬ ì‹¤íŒ¨');
          }
          
        } catch (error) {
          showLoading(false);
          
          showNotification('ë¡œê·¸ì•„ì›ƒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨í•©ë‹ˆë‹¤.', 'error');
          
          // ì˜¤ë¥˜ê°€ ë°œìƒí•´ë„ ê°•ì œë¡œ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ (ì„¸ì…˜ ì‚­ì œ ì‹œë„)
          setTimeout(() => {
            const baseUrl = window.location.href.split('?')[0];
            window.location.replace(baseUrl + '?logout=true&t=' + new Date().getTime());
          }, 1500);
        }
      }
    }
    
    /**
     * ğŸ“± ì™¸ë¶€ í´ë¦­ ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
     */
    document.addEventListener('click', function(event) {
      if (!event.target.closest('.user-menu')) {
        hideUserMenu();
      }
    });
    
    // ì›¹ì•± ê³µí†µ í•¨ìˆ˜ë“¤
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = 'notification ' + type;
      notification.textContent = message;
      notification.style.cssText = 
        'position: fixed;' +
        'top: 20px;' +
        'right: 20px;' +
        'padding: 15px 20px;' +
        'border-radius: 5px;' +
        'color: white;' +
        'font-weight: bold;' +
        'z-index: 1000;' +
        'animation: slideIn 0.3s ease-out;' +
        (type === 'success' ? 'background-color: #4CAF50;' : '') +
        (type === 'error' ? 'background-color: #f44336;' : '') +
        (type === 'info' ? 'background-color: #2196F3;' : '');
      
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease-in';
        setTimeout(() => {
          document.body.removeChild(notification);
        }, 300);
      }, 3000);
    }

    function showLoading(show = true) {
      let loader = document.getElementById('loading');
      if (show) {
        if (!loader) {
          loader = document.createElement('div');
          loader.id = 'loading';
          loader.innerHTML = '<div class="spinner"></div><p>ì²˜ë¦¬ ì¤‘...</p>';
          loader.style.cssText = 
            'position: fixed;' +
            'top: 0;' +
            'left: 0;' +
            'width: 100%;' +
            'height: 100%;' +
            'background-color: rgba(0,0,0,0.5);' +
            'display: flex;' +
            'flex-direction: column;' +
            'justify-content: center;' +
            'align-items: center;' +
            'z-index: 2000;' +
            'color: white;';
          document.body.appendChild(loader);
        }
        loader.style.display = 'flex';
      } else {
        if (loader) {
          loader.style.display = 'none';
        }
      }
    }

    function calculateDays(startDate, endDate, leaveType) {
      if (!startDate || !endDate) return 0;
      
      const start = new Date(startDate);
      const end = new Date(endDate);
      const diffTime = Math.abs(end - start);
      const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24)) + 1;
      
      if (leaveType === 'ë°˜ì°¨') {
        return 0.5;
      } else if (leaveType === 'ì—°ì°¨') {
        return diffDays;
      } else {
        return diffDays; // íŠ¹ë³„íœ´ê°€ëŠ” ì‹¤ì œ ì¼ìˆ˜
      }
    }

    /**
     * ğŸ”” ì•Œë¦¼ í™•ì¸ í•¨ìˆ˜
     */
    async function checkNotifications() {
      try {
        const notifications = await callServerFunction('getNotifications');
        updateNotificationBadge();
        return notifications;
      } catch (error) {
        console.error('ì•Œë¦¼ í™•ì¸ ì˜¤ë¥˜:', error);
        return [];
      }
    }
    
    // 60ì´ˆë§ˆë‹¤ ì•Œë¦¼ í™•ì¸ (ë„¤íŠ¸ì›Œí¬ ìš”ì²­ ë¹ˆë„ ì¤„ì„)
    setInterval(checkNotifications, 60000);

    // =====================================
    // ğŸ”§ ê´€ë¦¬ì ê¸°ëŠ¥ í•¨ìˆ˜ë“¤
    // =====================================

    /**
     * ğŸ” ë””ë²„ê¹…: ì‹œíŠ¸ ë°ì´í„° í™•ì¸ (ì„ì‹œ í•¨ìˆ˜)
     */
    async function debugEmployeeData() {
      try {
        const result = await callServerFunction('debugSheetData');
        console.log('ì‹œíŠ¸ ë””ë²„ê¹… ê²°ê³¼:', result);
        alert('ì‹œíŠ¸ ë””ë²„ê¹… ê²°ê³¼ë¥¼ ì½˜ì†”ì—ì„œ í™•ì¸í•˜ì„¸ìš”.');
        return result;
      } catch (error) {
        console.error('ë””ë²„ê¹… ì˜¤ë¥˜:', error);
        alert('ë””ë²„ê¹… ì˜¤ë¥˜: ' + error.message);
      }
    }

    /**
     * ğŸ‘¥ ì§ì› ê´€ë¦¬ í˜ì´ì§€ ë¡œë“œ
     */
    async function loadEmployeeManagement() {
      try {
        console.log('ğŸ” ì§ì› ê´€ë¦¬ í˜ì´ì§€ ë¡œë“œ ì‹œì‘');
        
        console.log('ğŸ“ getEmployeesForWeb ì„œë²„ í•¨ìˆ˜ í˜¸ì¶œ ì¤‘...');
        const employees = await callServerFunction('getEmployeesForWeb');
        console.log('âœ… getEmployeesForWeb ê²°ê³¼:', employees);
        
        console.log('ğŸ“ getAllDepartments ì„œë²„ í•¨ìˆ˜ í˜¸ì¶œ ì¤‘...');
        const departments = await callServerFunction('getAllDepartments');
        console.log('âœ… getAllDepartments ê²°ê³¼:', departments);
        
        // ì „ì—­ ì§ì› ëª©ë¡ ì €ì¥
        allEmployees = employees || [];
        
        // ë¶€ì„œ ì„ íƒ ì˜µì…˜ ì—…ë°ì´íŠ¸
        const deptSelect = document.getElementById('empDept');
        if (deptSelect) {
          deptSelect.innerHTML = '<option value="">ì„ íƒí•˜ì„¸ìš”</option>';
          departments.forEach(dept => {
            deptSelect.innerHTML += `<option value="${dept.deptId}">${dept.deptName}</option>`;
          });
        }
        
        // ì§ì› ëª©ë¡ í‘œì‹œ
        console.log('ğŸ“‹ ì§ì› ëª©ë¡ í‘œì‹œ ì¤‘...');
        displayEmployeeList(allEmployees);
        console.log('âœ… ì§ì› ê´€ë¦¬ í˜ì´ì§€ ë¡œë“œ ì™„ë£Œ');
        
      } catch (error) {
        console.error('âŒ ì§ì› ê´€ë¦¬ í˜ì´ì§€ ë¡œë“œ ì˜¤ë¥˜:', error);
        showNotification('ì§ì› ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
      }
    }

    /**
     * ğŸ‘¥ ì§ì› ëª©ë¡ í‘œì‹œ (í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©)
     */
    function displayEmployeeList(employees) {
      console.log('ğŸ“‹ displayEmployeeList í•¨ìˆ˜ í˜¸ì¶œë¨');
      console.log('ğŸ“Š ì „ë‹¬ë°›ì€ ì§ì› ë°ì´í„°:', employees);
      console.log('ğŸ“ˆ ì§ì› ìˆ˜:', employees ? employees.length : 'undefined');
      
      const tableBody = document.getElementById('employeeListTable');
      console.log('ğŸ¯ í…Œì´ë¸” ìš”ì†Œ:', tableBody);
      
      if (!employees || employees.length === 0) {
        console.log('âš ï¸ ì§ì› ë°ì´í„°ê°€ ì—†ìŒ - ë¹ˆ ë©”ì‹œì§€ í‘œì‹œ');
        tableBody.innerHTML = '<tr><td colspan="6" class="empty-message">ğŸ“‹ ë“±ë¡ëœ ì§ì›ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        hidePagination();
        return;
      }
      
      // í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©
      filteredEmployees = employees;
      initializePagination();
      
      // í˜„ì¬ í˜ì´ì§€ì˜ ì§ì›ë“¤ë§Œ í‘œì‹œ
      const startIndex = (currentPage - 1) * itemsPerPage;
      const endIndex = startIndex + itemsPerPage;
      const currentPageEmployees = filteredEmployees.slice(startIndex, endIndex);
      
      console.log('âœ… ì§ì› ëª©ë¡ í…Œì´ë¸” ìƒì„± ì¤‘...');
      const tableHTML = currentPageEmployees.map(emp => `
        <tr>
          <td class="col-empid">${emp.empId}</td>
          <td class="col-name">${emp.name}</td>
          <td class="col-email">${emp.email}</td>
          <td class="col-dept">${emp.deptName || 'ë¯¸ì§€ì •'}</td>
          <td class="col-position">${emp.position || '-'}</td>
          <td class="col-actions">
            <button class="btn btn-secondary" onclick="editEmployee('${emp.empId}')">
              <span class="btn-icon">âœï¸</span>
              <span class="btn-text">ìˆ˜ì •</span>
            </button>
            <button class="btn btn-danger" onclick="deleteEmployee('${emp.empId}')">
              <span class="btn-icon">ğŸ—‘ï¸</span>
              <span class="btn-text">ì‚­ì œ</span>
            </button>
          </td>
        </tr>
      `).join('');
      
      console.log('ğŸ“ ìƒì„±ëœ HTML:', tableHTML);
      tableBody.innerHTML = tableHTML;
      updatePaginationUI();
      console.log('âœ… ì§ì› ëª©ë¡ í‘œì‹œ ì™„ë£Œ');
    }
    
    /**
     * ğŸ“„ í˜ì´ì§€ë„¤ì´ì…˜ ì´ˆê¸°í™”
     */
    function initializePagination() {
      const totalItems = filteredEmployees.length;
      totalPages = Math.ceil(totalItems / itemsPerPage);
      
      // í˜„ì¬ í˜ì´ì§€ê°€ ì´ í˜ì´ì§€ ìˆ˜ë¥¼ ì´ˆê³¼í•˜ë©´ 1í˜ì´ì§€ë¡œ ì´ë™
      if (currentPage > totalPages) {
        currentPage = 1;
      }
      
      // í˜ì´ì§€ë„¤ì´ì…˜ UI í‘œì‹œ/ìˆ¨ê¹€
      const paginationContainer = document.getElementById('employeePagination');
      if (totalPages > 1) {
        paginationContainer.style.display = 'flex';
      } else {
        paginationContainer.style.display = 'none';
      }
      
      console.log('ğŸ“„ í˜ì´ì§€ë„¤ì´ì…˜ ì´ˆê¸°í™”: ì´ ' + totalItems + 'ê°œ í•­ëª©, ' + totalPages + 'í˜ì´ì§€');
    }
    
    /**
     * ğŸ™ˆ í˜ì´ì§€ë„¤ì´ì…˜ ìˆ¨ê¹€
     */
    function hidePagination() {
      const paginationContainer = document.getElementById('employeePagination');
      paginationContainer.style.display = 'none';
    }
    
    /**
     * ğŸ”„ í˜ì´ì§€ë„¤ì´ì…˜ UI ì—…ë°ì´íŠ¸
     */
    function updatePaginationUI() {
      const totalItems = filteredEmployees.length;
      const startItem = (currentPage - 1) * itemsPerPage + 1;
      const endItem = Math.min(currentPage * itemsPerPage, totalItems);
      
      // ì •ë³´ í…ìŠ¤íŠ¸ ì—…ë°ì´íŠ¸
      document.getElementById('paginationInfo').textContent = 
        `${startItem}-${endItem} of ${totalItems} ì§ì›`;
      
      // í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ë“¤ ìƒì„±
      generatePageNumbers();
      
      // ì´ì „/ë‹¤ìŒ ë²„íŠ¼ ìƒíƒœ ì—…ë°ì´íŠ¸
      document.getElementById('firstPageBtn').disabled = currentPage === 1;
      document.getElementById('prevPageBtn').disabled = currentPage === 1;
      document.getElementById('nextPageBtn').disabled = currentPage === totalPages;
      document.getElementById('lastPageBtn').disabled = currentPage === totalPages;
    }
    
    /**
     * ğŸ”¢ í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ ìƒì„±
     */
    function generatePageNumbers() {
      const pageNumbersContainer = document.getElementById('pageNumbers');
      pageNumbersContainer.innerHTML = '';
      
      // í˜ì´ì§€ ë²ˆí˜¸ í‘œì‹œ ë¡œì§ (ìµœëŒ€ 7ê°œ ë²„íŠ¼)
      let startPage = Math.max(1, currentPage - 3);
      let endPage = Math.min(totalPages, currentPage + 3);
      
      // ì‹œì‘ í˜ì´ì§€ ì¡°ì •
      if (endPage - startPage < 6) {
        if (startPage === 1) {
          endPage = Math.min(totalPages, startPage + 6);
        } else {
          startPage = Math.max(1, endPage - 6);
        }
      }
      
      // í˜ì´ì§€ ë²ˆí˜¸ ë²„íŠ¼ ìƒì„±
      for (let i = startPage; i <= endPage; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = 'pagination-btn' + (i === currentPage ? ' active' : '');
        pageBtn.textContent = i;
        pageBtn.onclick = () => goToPage(i);
        pageNumbersContainer.appendChild(pageBtn);
      }
    }
    
    /**
     * ğŸ“„ íŠ¹ì • í˜ì´ì§€ë¡œ ì´ë™
     */
    function goToPage(pageNumber) {
      if (pageNumber < 1 || pageNumber > totalPages) {
        return;
      }
      
      currentPage = pageNumber;
      displayEmployeeList(filteredEmployees);
      
      console.log('ğŸ“„ í˜ì´ì§€ ì´ë™: ' + pageNumber + 'í˜ì´ì§€');
    }
    
    /**
     * ğŸ“Š í˜ì´ì§€ë‹¹ í•­ëª© ìˆ˜ ë³€ê²½
     */
    function changeItemsPerPage() {
      const select = document.getElementById('itemsPerPage');
      itemsPerPage = parseInt(select.value);
      currentPage = 1; // ì²« í˜ì´ì§€ë¡œ ì´ë™
      
      displayEmployeeList(filteredEmployees);
      
      console.log('ğŸ“Š í˜ì´ì§€ë‹¹ í•­ëª© ìˆ˜ ë³€ê²½: ' + itemsPerPage + 'ê°œ');
    }

    /**
     * ğŸ” ì§ì› ê²€ìƒ‰ ê¸°ëŠ¥ (í˜ì´ì§€ë„¤ì´ì…˜ ì—°ë™)
     */
    function searchEmployees() {
      const searchTerm = document.getElementById('employeeSearchInput').value.toLowerCase().trim();
      
      if (!searchTerm) {
        // ê²€ìƒ‰ì–´ê°€ ì—†ìœ¼ë©´ ì „ì²´ ëª©ë¡ í‘œì‹œ
        currentPage = 1; // ì²« í˜ì´ì§€ë¡œ ì´ë™
        displayEmployeeList(allEmployees);
        return;
      }
      
      // ê²€ìƒ‰ì–´ì— ë§ëŠ” ì§ì› í•„í„°ë§
      const searchFilteredEmployees = allEmployees.filter(emp => {
        const empId = emp.empId.toLowerCase();
        const name = emp.name.toLowerCase();
        const email = emp.email.toLowerCase();
        const deptName = (emp.deptName || '').toLowerCase();
        const position = (emp.position || '').toLowerCase();
        
        return empId.includes(searchTerm) || 
               name.includes(searchTerm) || 
               email.includes(searchTerm) || 
               deptName.includes(searchTerm) || 
               position.includes(searchTerm);
      });
      
      // ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ
      currentPage = 1; // ê²€ìƒ‰ ì‹œ ì²« í˜ì´ì§€ë¡œ ì´ë™
      displayEmployeeList(searchFilteredEmployees);
      
      // ê²€ìƒ‰ ê²°ê³¼ ë©”ì‹œì§€ í‘œì‹œ
      if (searchFilteredEmployees.length === 0) {
        const tableBody = document.getElementById('employeeListTable');
        tableBody.innerHTML = '<tr><td colspan="6" class="search-empty-message">ğŸ” ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•´ë³´ì„¸ìš”.</td></tr>';
        hidePagination();
      }
      
      console.log('ğŸ” ê²€ìƒ‰ ì™„ë£Œ: "' + searchTerm + '" -> ' + searchFilteredEmployees.length + 'ê°œ ê²°ê³¼');
    }

    /**
     * ğŸ”„ ì§ì› ê²€ìƒ‰ ì´ˆê¸°í™”
     */
    function clearEmployeeSearch() {
      document.getElementById('employeeSearchInput').value = '';
      currentPage = 1; // ì²« í˜ì´ì§€ë¡œ ì´ë™
      displayEmployeeList(allEmployees); // ì „ì²´ ëª©ë¡ í‘œì‹œ
      console.log('ğŸ”„ ê²€ìƒ‰ ì´ˆê¸°í™” ì™„ë£Œ');
    }

    /**
     * ğŸ‘¥ ì§ì› ì¶”ê°€
     */
    async function addEmployee(event) {
      event.preventDefault();
      
      const formData = {
        name: document.getElementById('empName').value,
        email: document.getElementById('empEmail').value,
        phone: document.getElementById('empPhone').value,
        deptId: document.getElementById('empDept').value,
        position: document.getElementById('empPosition').value
      };
      
      try {
        showLoading(true);
        const result = await callServerFunction('addEmployee', formData);
        
        if (result.success) {
          // ìƒì„¸í•œ ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ
          const successMessage = `
            âœ… ì§ì›ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!
            
            ğŸ“‹ ìƒì„±ëœ ì‚¬ë²ˆ: ${result.empId}
            ğŸ“§ ì´ë©”ì¼: ${result.loginInfo.email}
            ğŸ”‘ ì´ˆê¸° ë¹„ë°€ë²ˆí˜¸: ${result.loginInfo.password}
            
            âš ï¸ í•´ë‹¹ ì§ì›ì—ê²Œ ë¡œê·¸ì¸ ì •ë³´ë¥¼ ì•ˆì „í•˜ê²Œ ì „ë‹¬í•´ì£¼ì„¸ìš”.
            ì²« ë¡œê·¸ì¸ ì‹œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ì´ í•„ìš”í•©ë‹ˆë‹¤.
          `;
          
          alert(successMessage);
          showNotification('ì§ì› ì¶”ê°€ ì™„ë£Œ (ì‚¬ë²ˆ: ' + result.empId + ')', 'success');
          document.getElementById('addEmployeeForm').reset();
          
          // ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (ìµœì‹  ì§ì›ì´ ë§¨ ìœ„ì— í‘œì‹œë¨)
          await refreshEmployeeList();
          
          // ê²€ìƒ‰ì°½ ì´ˆê¸°í™”
          clearEmployeeSearch();
          
        } else {
          showNotification('ì§ì› ì¶”ê°€ ì‹¤íŒ¨: ' + result.error, 'error');
        }
      } catch (error) {
        console.error('ì§ì› ì¶”ê°€ ì˜¤ë¥˜:', error);
        showNotification('ì§ì› ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }

    /**
     * ğŸ”„ ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨ (í˜ì´ì§€ë„¤ì´ì…˜ ì—°ë™)
     */
    async function refreshEmployeeList() {
      try {
        console.log('ğŸ”„ ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì¤‘...');
        const employees = await callServerFunction('getEmployeesForWeb');
        
        // ì „ì—­ ë³€ìˆ˜ ì—…ë°ì´íŠ¸
        allEmployees = employees || [];
        
        // í˜„ì¬ ê²€ìƒ‰ ìƒíƒœ í™•ì¸
        const searchTerm = document.getElementById('employeeSearchInput').value.toLowerCase().trim();
        
        if (searchTerm) {
          // ê²€ìƒ‰ ì¤‘ì´ë©´ ë‹¤ì‹œ ê²€ìƒ‰ ì‹¤í–‰
          searchEmployees();
        } else {
          // ê²€ìƒ‰ ì¤‘ì´ ì•„ë‹ˆë©´ ì „ì²´ ëª©ë¡ í‘œì‹œ (í˜„ì¬ í˜ì´ì§€ ìœ ì§€)
          displayEmployeeList(allEmployees);
        }
        
        console.log('âœ… ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì™„ë£Œ (ì´ ' + allEmployees.length + 'ëª…)');
      } catch (error) {
        console.error('âŒ ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì˜¤ë¥˜:', error);
        showNotification('ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      }
    }

    /**
     * ğŸ¢ ë¶€ì„œ ê´€ë¦¬ í˜ì´ì§€ ë¡œë“œ
     */
    async function loadDepartmentManagement() {
      try {
        const departments = await callServerFunction('getAllDepartments');
        displayDepartmentList(departments);
      } catch (error) {
        console.error('ë¶€ì„œ ê´€ë¦¬ í˜ì´ì§€ ë¡œë“œ ì˜¤ë¥˜:', error);
        showNotification('ë¶€ì„œ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
      }
    }

    /**
     * ğŸ¢ ë¶€ì„œ ëª©ë¡ í‘œì‹œ (ê°œì„ ëœ ë²„ì „)
     */
    function displayDepartmentList(departments) {
      const tableBody = document.getElementById('departmentListTable');
      
      if (!departments || departments.length === 0) {
        tableBody.innerHTML = '<tr><td colspan="4" class="empty-message">ğŸ¢ ë“±ë¡ëœ ë¶€ì„œê°€ ì—†ìŠµë‹ˆë‹¤.</td></tr>';
        return;
      }
      
      tableBody.innerHTML = departments.map(dept => `
        <tr>
          <td style="text-align: center; font-weight: 600;">${dept.deptId}</td>
          <td style="font-weight: 500;">${dept.deptName}</td>
          <td style="text-align: center;">
            <span style="color: ${dept.employeeCount > 0 ? '#28a745' : '#6c757d'}; font-weight: 600;">
              ${dept.employeeCount || 0}ëª…
            </span>
          </td>
          <td style="text-align: center;">
            <button class="btn btn-secondary" onclick="editDepartment('${dept.deptId}')" style="margin-right: 0.5rem;">
              <span>âœï¸</span> ìˆ˜ì •
            </button>
            <button class="btn btn-danger" onclick="deleteDepartment('${dept.deptId}', '${dept.deptName}', ${dept.employeeCount || 0})">
              <span>ğŸ—‘ï¸</span> ì‚­ì œ
            </button>
          </td>
        </tr>
      `).join('');
    }

    /**
     * ğŸ¢ ë¶€ì„œ ì¶”ê°€
     */
    async function addDepartment(event) {
      event.preventDefault();
      
      const formData = {
        deptId: document.getElementById('deptId').value,
        deptName: document.getElementById('deptName').value
      };
      
      try {
        showLoading(true);
        const result = await callServerFunction('addDepartment', formData);
        
        if (result.success) {
          showNotification('ë¶€ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          document.getElementById('addDepartmentForm').reset();
          loadDepartmentManagement(); // ëª©ë¡ ìƒˆë¡œê³ ì¹¨
        } else {
          showNotification('ë¶€ì„œ ì¶”ê°€ ì‹¤íŒ¨: ' + result.error, 'error');
        }
      } catch (error) {
        console.error('ë¶€ì„œ ì¶”ê°€ ì˜¤ë¥˜:', error);
        showNotification('ë¶€ì„œ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }

    /**
     * âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì • í˜ì´ì§€ ë¡œë“œ
     */
    async function loadSystemSettings() {
      try {
        const settings = await callServerFunction('getSystemSettings');
        
        // ì„¤ì •ê°’ë“¤ì„ í¼ì— ì ìš©
        if (settings) {
          document.getElementById('basicLeaves').value = settings.basicLeaves || 15;
          document.getElementById('maxLeaves').value = settings.maxLeaves || 25;
          document.getElementById('sessionTimeout').value = settings.sessionTimeout || 120;
          document.getElementById('leavePolicy').value = settings.leavePolicy || 'ì…ì‚¬ì¼ ê¸°ì¤€';
        }
      } catch (error) {
        console.error('ì‹œìŠ¤í…œ ì„¤ì • ë¡œë“œ ì˜¤ë¥˜:', error);
        showNotification('ì‹œìŠ¤í…œ ì„¤ì •ì„ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
      }
    }

    /**
     * âš™ï¸ ì‹œìŠ¤í…œ ì„¤ì • ì—…ë°ì´íŠ¸
     */
    async function updateSystemSettings(event) {
      event.preventDefault();
      
      const settings = {
        basicLeaves: document.getElementById('basicLeaves').value,
        maxLeaves: document.getElementById('maxLeaves').value,
        sessionTimeout: document.getElementById('sessionTimeout').value,
        leavePolicy: document.getElementById('leavePolicy').value
      };
      
      try {
        showLoading(true);
        const result = await callServerFunction('updateSystemSettings', settings);
        
        if (result.success) {
          showNotification('ì‹œìŠ¤í…œ ì„¤ì •ì´ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        } else {
          showNotification('ì„¤ì • ì €ì¥ ì‹¤íŒ¨: ' + result.error, 'error');
        }
      } catch (error) {
        console.error('ì‹œìŠ¤í…œ ì„¤ì • ì €ì¥ ì˜¤ë¥˜:', error);
        showNotification('ì„¤ì • ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }

    /**
     * ğŸ“ˆ í†µê³„ í˜ì´ì§€ ë¡œë“œ
     */
    async function loadStatistics() {
      try {
        const stats = await callServerFunction('getSystemStatistics');
        
        if (stats) {
          document.getElementById('totalEmployees').textContent = stats.totalEmployees || '0';
          document.getElementById('totalRequests').textContent = stats.totalRequests || '0';
          document.getElementById('approvedRequests').textContent = stats.approvedRequests || '0';
          document.getElementById('totalLeaveDays').textContent = stats.totalLeaveDays || '0';
        }
      } catch (error) {
        console.error('í†µê³„ ë°ì´í„° ë¡œë“œ ì˜¤ë¥˜:', error);
        showNotification('í†µê³„ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
      }
    }

    /**
     * ğŸ“¥ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
     */
    async function exportData() {
      try {
        showLoading(true);
        const result = await callServerFunction('exportSystemData');
        
        if (result.success) {
          showNotification('ë°ì´í„° ë‚´ë³´ë‚´ê¸°ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
          // ë‹¤ìš´ë¡œë“œ ë§í¬ ì œê³µ ë“±ì˜ ì¶”ê°€ ì²˜ë¦¬
        } else {
          showNotification('ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì‹¤íŒ¨: ' + result.error, 'error');
        }
      } catch (error) {
        console.error('ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì˜¤ë¥˜:', error);
        showNotification('ë°ì´í„° ë‚´ë³´ë‚´ê¸° ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }

    /**
     * ğŸ’¾ ë°±ì—… ìƒì„±
     */
    async function backupData() {
      try {
        showLoading(true);
        const result = await callServerFunction('createSystemBackup');
        
        if (result.success) {
          showNotification('ì‹œìŠ¤í…œ ë°±ì—…ì´ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        } else {
          showNotification('ë°±ì—… ìƒì„± ì‹¤íŒ¨: ' + result.error, 'error');
        }
      } catch (error) {
        console.error('ë°±ì—… ìƒì„± ì˜¤ë¥˜:', error);
        showNotification('ë°±ì—… ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }

    /**
     * âœï¸ ì§ì› ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸°
     */
    async function editEmployee(empId) {
      try {
        console.log('ğŸ“ ì§ì› ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸°:', empId);
        
        // í•´ë‹¹ ì§ì› ì •ë³´ ì°¾ê¸°
        const employee = allEmployees.find(emp => emp.empId === empId);
        if (!employee) {
          showNotification('ì§ì› ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
          return;
        }
        
        // ëª¨ë‹¬ í•„ë“œì— ê¸°ì¡´ ë°ì´í„° ì±„ìš°ê¸°
        document.getElementById('editEmpId').value = employee.empId;
        document.getElementById('editEmpName').value = employee.name;
        document.getElementById('editEmpEmail').value = employee.email;
        document.getElementById('editEmpPhone').value = employee.phone || '';
        document.getElementById('editEmpDept').value = employee.deptId || '';
        document.getElementById('editEmpPosition').value = employee.position || '';
        document.getElementById('resetPasswordCheckbox').checked = false;
        
        // ë¶€ì„œ ì„ íƒ ì˜µì…˜ ì—…ë°ì´íŠ¸
        await loadDepartmentOptionsForEdit();
        
        // ëª¨ë‹¬ ì—´ê¸°
        const modal = document.getElementById('editEmployeeModal');
        modal.style.display = 'flex';
        
        // ë©”ì‹œì§€ ì´ˆê¸°í™”
        const messageDiv = document.getElementById('editEmployeeMessage');
        messageDiv.style.display = 'none';
        
        console.log('âœ… ì§ì› ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸° ì™„ë£Œ');
      } catch (error) {
        console.error('âŒ ì§ì› ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸° ì˜¤ë¥˜:', error);
        showNotification('ì§ì› ìˆ˜ì • ëª¨ë‹¬ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
      }
    }

    /**
     * ğŸ¢ ìˆ˜ì • ëª¨ë‹¬ìš© ë¶€ì„œ ì˜µì…˜ ë¡œë“œ
     */
    async function loadDepartmentOptionsForEdit() {
      try {
        const departments = await callServerFunction('getAllDepartments');
        const selectElement = document.getElementById('editEmpDept');
        
        selectElement.innerHTML = '<option value="">ì„ íƒí•˜ì„¸ìš”</option>';
        departments.forEach(dept => {
          selectElement.innerHTML += `<option value="${dept.deptId}">${dept.deptName}</option>`;
        });
      } catch (error) {
        console.error('ë¶€ì„œ ì˜µì…˜ ë¡œë“œ ì˜¤ë¥˜:', error);
      }
    }

    /**
     * ğŸ’¾ ì§ì› ì •ë³´ ë³€ê²½ì‚¬í•­ ì €ì¥
     */
    async function saveEmployeeChanges() {
      try {
        const empId = document.getElementById('editEmpId').value;
        const name = document.getElementById('editEmpName').value.trim();
        const email = document.getElementById('editEmpEmail').value.trim();
        const phone = document.getElementById('editEmpPhone').value.trim();
        const deptId = document.getElementById('editEmpDept').value;
        const position = document.getElementById('editEmpPosition').value.trim();
        const resetPassword = document.getElementById('resetPasswordCheckbox').checked;
        
        // í•„ìˆ˜ í•„ë“œ ê²€ì¦
        if (!name || !email || !deptId) {
          showEditEmployeeMessage('ì´ë¦„, ì´ë©”ì¼, ë¶€ì„œëŠ” í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.', 'error');
          return;
        }
        
        // ì´ë©”ì¼ í˜•ì‹ ê²€ì¦
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        if (!emailRegex.test(email)) {
          showEditEmployeeMessage('ì˜¬ë°”ë¥¸ ì´ë©”ì¼ í˜•ì‹ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
          return;
        }
        
        // ì €ì¥ ë²„íŠ¼ ë¹„í™œì„±í™”
        const saveBtn = document.querySelector('.btn-modal-primary');
        saveBtn.disabled = true;
        saveBtn.innerHTML = '<span>ğŸ’¾</span> ì €ì¥ ì¤‘...';
        
        // ì„œë²„ì— ë³€ê²½ì‚¬í•­ ì „ì†¡
        const updateData = {
          empId: empId,
          name: name,
          email: email,
          phone: phone,
          deptId: deptId,
          position: position,
          resetPassword: resetPassword
        };
        
        const result = await callServerFunction('updateEmployee', updateData);
        
        if (result.success) {
          showEditEmployeeMessage('ì§ì› ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
          
          // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ í›„ ëª¨ë‹¬ ë‹«ê¸°
          setTimeout(() => {
            closeEditEmployeeModal();
            showNotification('ì§ì› ì •ë³´ ìˆ˜ì • ì™„ë£Œ', 'success');
            
            // ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            refreshEmployeeList();
          }, 1500);
          
        } else {
          showEditEmployeeMessage('ì§ì› ì •ë³´ ìˆ˜ì • ì‹¤íŒ¨: ' + result.error, 'error');
        }
        
      } catch (error) {
        console.error('âŒ ì§ì› ì •ë³´ ì €ì¥ ì˜¤ë¥˜:', error);
        showEditEmployeeMessage('ì§ì› ì •ë³´ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        // ì €ì¥ ë²„íŠ¼ í™œì„±í™”
        const saveBtn = document.querySelector('.btn-modal-primary');
        saveBtn.disabled = false;
        saveBtn.innerHTML = '<span>ğŸ’¾</span> ì €ì¥';
      }
    }

    /**
     * ğŸš« ì§ì› ìˆ˜ì • ëª¨ë‹¬ ë‹«ê¸°
     */
    function closeEditEmployeeModal() {
      const modal = document.getElementById('editEmployeeModal');
      modal.style.display = 'none';
      
      // í¼ ì´ˆê¸°í™”
      document.getElementById('editEmployeeForm').reset();
      
      // ë©”ì‹œì§€ ì´ˆê¸°í™”
      const messageDiv = document.getElementById('editEmployeeMessage');
      messageDiv.style.display = 'none';
    }

    /**
     * ğŸ“§ ìˆ˜ì • ëª¨ë‹¬ ë‚´ ë©”ì‹œì§€ í‘œì‹œ
     */
    function showEditEmployeeMessage(message, type) {
      const messageDiv = document.getElementById('editEmployeeMessage');
      messageDiv.textContent = message;
      messageDiv.className = 'alert';
      
      if (type === 'success') {
        messageDiv.classList.add('alert-success');
      } else if (type === 'error') {
        messageDiv.classList.add('alert-error');
      }
      
      messageDiv.style.display = 'block';
      
      // ìë™ ìˆ¨ê¹€ (ì„±ê³µ ë©”ì‹œì§€ê°€ ì•„ë‹Œ ê²½ìš°)
      if (type !== 'success') {
        setTimeout(() => {
          messageDiv.style.display = 'none';
        }, 5000);
      }
    }

    /**
     * ğŸ—‘ï¸ ì§ì› ì‚­ì œ (2ë‹¨ê³„ í™•ì¸)
     */
    async function deleteEmployee(empId) {
      try {
        // í•´ë‹¹ ì§ì› ì •ë³´ ì°¾ê¸°
        const employee = allEmployees.find(emp => emp.empId === empId);
        if (!employee) {
          showNotification('ì§ì› ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
          return;
        }
        
        // 1ë‹¨ê³„ í™•ì¸
        const firstConfirm = confirm(
          `âš ï¸ ì§ì› ì‚­ì œ í™•ì¸\n\n` +
          `ì‚¬ë²ˆ: ${employee.empId}\n` +
          `ì´ë¦„: ${employee.name}\n` +
          `ì´ë©”ì¼: ${employee.email}\n\n` +
          `ì •ë§ë¡œ ì´ ì§ì›ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`
        );
        
        if (!firstConfirm) {
          return;
        }
        
        // 2ë‹¨ê³„ í™•ì¸ (ì•ˆì „ì¥ì¹˜)
        const secondConfirm = confirm(
          `ğŸš¨ ìµœì¢… í™•ì¸\n\n` +
          `"${employee.name}" ì§ì›ì„ ì‚­ì œí•˜ë©´ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n` +
          `ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n` +
          `ì‚­ì œí•˜ë ¤ë©´ "í™•ì¸"ì„ í´ë¦­í•˜ì„¸ìš”.`
        );
        
        if (!secondConfirm) {
          return;
        }
        
        // ë¡œë”© í‘œì‹œ
        showLoading(true);
        
        // ì„œë²„ì— ì‚­ì œ ìš”ì²­
        const result = await callServerFunction('deleteEmployee', empId);
        
        if (result.success) {
          showNotification(`${employee.name} ì§ì›ì´ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
          
          // ì§ì› ëª©ë¡ ìƒˆë¡œê³ ì¹¨
          await refreshEmployeeList();
          
          // ê²€ìƒ‰ì°½ ì´ˆê¸°í™”
          clearEmployeeSearch();
          
        } else {
          showNotification('ì§ì› ì‚­ì œ ì‹¤íŒ¨: ' + result.error, 'error');
        }
        
      } catch (error) {
        console.error('âŒ ì§ì› ì‚­ì œ ì˜¤ë¥˜:', error);
        showNotification('ì§ì› ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }

    /**
     * âœï¸ ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸°
     */
    async function editDepartment(deptId) {
      try {
        console.log('ğŸ¢ ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸°:', deptId);
        
        // í•´ë‹¹ ë¶€ì„œ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        const department = await callServerFunction('getDepartmentById', deptId);
        if (!department) {
          showNotification('ë¶€ì„œ ì •ë³´ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
          return;
        }
        
        // ëª¨ë‹¬ í•„ë“œì— ê¸°ì¡´ ë°ì´í„° ì±„ìš°ê¸°
        document.getElementById('editDeptId').value = department.deptId;
        document.getElementById('editDeptName').value = department.deptName;
        
        // ëª¨ë‹¬ ì—´ê¸°
        const modal = document.getElementById('editDepartmentModal');
        modal.style.display = 'flex';
        
        // ë©”ì‹œì§€ ì´ˆê¸°í™”
        const messageDiv = document.getElementById('editDepartmentMessage');
        messageDiv.style.display = 'none';
        
        console.log('âœ… ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸° ì™„ë£Œ');
      } catch (error) {
        console.error('âŒ ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ ì—´ê¸° ì˜¤ë¥˜:', error);
        showNotification('ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ì„ ì—´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'error');
      }
    }

    /**
     * ğŸš« ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ ë‹«ê¸°
     */
    function closeEditDepartmentModal() {
      const modal = document.getElementById('editDepartmentModal');
      modal.style.display = 'none';
      
      // í¼ ì´ˆê¸°í™”
      document.getElementById('editDepartmentForm').reset();
      
      // ë©”ì‹œì§€ ì´ˆê¸°í™”
      const messageDiv = document.getElementById('editDepartmentMessage');
      messageDiv.style.display = 'none';
    }

    /**
     * ğŸ’¾ ë¶€ì„œ ì •ë³´ ë³€ê²½ì‚¬í•­ ì €ì¥
     */
    async function saveDepartmentChanges() {
      try {
        const deptId = document.getElementById('editDeptId').value;
        const deptName = document.getElementById('editDeptName').value.trim();
        
        // í•„ìˆ˜ í•„ë“œ ê²€ì¦
        if (!deptName) {
          showEditDepartmentMessage('ë¶€ì„œëª…ì€ í•„ìˆ˜ ì…ë ¥ í•­ëª©ì…ë‹ˆë‹¤.', 'error');
          return;
        }
        
        // ë¶€ì„œëª… ê¸¸ì´ ê²€ì¦
        if (deptName.length < 2 || deptName.length > 20) {
          showEditDepartmentMessage('ë¶€ì„œëª…ì€ 2ì ì´ìƒ 20ì ì´í•˜ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
          return;
        }
        
        // ì €ì¥ ë²„íŠ¼ ë¹„í™œì„±í™”
        const saveBtn = document.querySelector('#editDepartmentModal .btn-modal-primary');
        saveBtn.disabled = true;
        saveBtn.innerHTML = '<span>ğŸ’¾</span> ì €ì¥ ì¤‘...';
        
        // ì„œë²„ì— ë³€ê²½ì‚¬í•­ ì „ì†¡
        const updateData = {
          deptId: deptId,
          deptName: deptName
        };
        
        const result = await callServerFunction('updateDepartment', updateData);
        
        if (result.success) {
          showEditDepartmentMessage('ë¶€ì„œ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
          
          // ì„±ê³µ ë©”ì‹œì§€ í‘œì‹œ í›„ ëª¨ë‹¬ ë‹«ê¸°
          setTimeout(() => {
            closeEditDepartmentModal();
            showNotification('ë¶€ì„œ ì •ë³´ ìˆ˜ì • ì™„ë£Œ', 'success');
            
            // ë¶€ì„œ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
            loadDepartmentManagement();
          }, 1500);
          
        } else {
          showEditDepartmentMessage('ë¶€ì„œ ì •ë³´ ìˆ˜ì • ì‹¤íŒ¨: ' + result.error, 'error');
        }
        
      } catch (error) {
        console.error('âŒ ë¶€ì„œ ì •ë³´ ì €ì¥ ì˜¤ë¥˜:', error);
        showEditDepartmentMessage('ë¶€ì„œ ì •ë³´ ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        // ì €ì¥ ë²„íŠ¼ í™œì„±í™”
        const saveBtn = document.querySelector('#editDepartmentModal .btn-modal-primary');
        saveBtn.disabled = false;
        saveBtn.innerHTML = '<span>ğŸ’¾</span> ì €ì¥';
      }
    }

    /**
     * ğŸ“§ ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ ë‚´ ë©”ì‹œì§€ í‘œì‹œ
     */
    function showEditDepartmentMessage(message, type) {
      const messageDiv = document.getElementById('editDepartmentMessage');
      messageDiv.textContent = message;
      messageDiv.className = 'alert';
      
      if (type === 'success') {
        messageDiv.classList.add('alert-success');
      } else if (type === 'error') {
        messageDiv.classList.add('alert-error');
      }
      
      messageDiv.style.display = 'block';
      
      // ìë™ ìˆ¨ê¹€ (ì„±ê³µ ë©”ì‹œì§€ê°€ ì•„ë‹Œ ê²½ìš°)
      if (type !== 'success') {
        setTimeout(() => {
          messageDiv.style.display = 'none';
        }, 5000);
      }
    }

    /**
     * ğŸ—‘ï¸ ë¶€ì„œ ì‚­ì œ (ìŠ¤ë§ˆíŠ¸ ì•ˆì „ì¥ì¹˜)
     */
    async function deleteDepartment(deptId, deptName, employeeCount) {
      try {
        console.log('ğŸ—‘ï¸ ë¶€ì„œ ì‚­ì œ ìš”ì²­:', deptId, deptName, employeeCount);
        
        // ì†Œì† ì§ì›ì´ ìˆëŠ”ì§€ í™•ì¸
        if (employeeCount > 0) {
          alert(
            `âš ï¸ ë¶€ì„œ ì‚­ì œ ë¶ˆê°€\n\n` +
            `ë¶€ì„œëª…: ${deptName}\n` +
            `ì†Œì† ì§ì›: ${employeeCount}ëª…\n\n` +
            `ì†Œì† ì§ì›ì´ ìˆëŠ” ë¶€ì„œëŠ” ì‚­ì œí•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n` +
            `ë¨¼ì € ì†Œì† ì§ì›ë“¤ì„ ë‹¤ë¥¸ ë¶€ì„œë¡œ ì´ë™ì‹œí‚¨ í›„ ì‚­ì œí•´ì£¼ì„¸ìš”.`
          );
          return;
        }
        
        // 1ë‹¨ê³„ í™•ì¸
        const firstConfirm = confirm(
          `âš ï¸ ë¶€ì„œ ì‚­ì œ í™•ì¸\n\n` +
          `ë¶€ì„œì½”ë“œ: ${deptId}\n` +
          `ë¶€ì„œëª…: ${deptName}\n` +
          `ì†Œì† ì§ì›: ${employeeCount}ëª…\n\n` +
          `ì •ë§ë¡œ ì´ ë¶€ì„œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`
        );
        
        if (!firstConfirm) {
          return;
        }
        
        // 2ë‹¨ê³„ í™•ì¸ (ì•ˆì „ì¥ì¹˜)
        const secondConfirm = confirm(
          `ğŸš¨ ìµœì¢… í™•ì¸\n\n` +
          `"${deptName}" ë¶€ì„œë¥¼ ì‚­ì œí•˜ë©´ ë³µêµ¬í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.\n` +
          `ë¶€ì„œ ê´€ë ¨ ëª¨ë“  ì´ë ¥ì´ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.\n\n` +
          `ì •ë§ë¡œ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n` +
          `ì‚­ì œí•˜ë ¤ë©´ "í™•ì¸"ì„ í´ë¦­í•˜ì„¸ìš”.`
        );
        
        if (!secondConfirm) {
          return;
        }
        
        // ë¡œë”© í‘œì‹œ
        showLoading(true);
        
        // ì„œë²„ì— ì‚­ì œ ìš”ì²­
        const result = await callServerFunction('deleteDepartment', deptId);
        
        if (result.success) {
          showNotification(`${deptName} ë¶€ì„œê°€ ì„±ê³µì ìœ¼ë¡œ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`, 'success');
          
          // ë¶€ì„œ ëª©ë¡ ìƒˆë¡œê³ ì¹¨
          loadDepartmentManagement();
          
        } else {
          showNotification('ë¶€ì„œ ì‚­ì œ ì‹¤íŒ¨: ' + result.error, 'error');
        }
        
      } catch (error) {
        console.error('âŒ ë¶€ì„œ ì‚­ì œ ì˜¤ë¥˜:', error);
        showNotification('ë¶€ì„œ ì‚­ì œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
      } finally {
        showLoading(false);
      }
    }
    
    /**
     * ğŸ¯ ëª¨ë‹¬ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
     */
    document.addEventListener('DOMContentLoaded', function() {
      // ì§ì› ìˆ˜ì • ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
      const editEmployeeModal = document.getElementById('editEmployeeModal');
      if (editEmployeeModal) {
        editEmployeeModal.addEventListener('click', function(event) {
          // ëª¨ë‹¬ ë°°ê²½(overlay)ì„ í´ë¦­í–ˆì„ ë•Œë§Œ ë‹«ê¸° (ëª¨ë‹¬ ë‚´ìš© í´ë¦­ ì‹œì—ëŠ” ë‹«ì§€ ì•ŠìŒ)
          if (event.target === editEmployeeModal) {
            closeEditEmployeeModal();
          }
        });
      }
      
      // ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ ë°°ê²½ í´ë¦­ ì‹œ ë‹«ê¸°
      const editDepartmentModal = document.getElementById('editDepartmentModal');
      if (editDepartmentModal) {
        editDepartmentModal.addEventListener('click', function(event) {
          // ëª¨ë‹¬ ë°°ê²½(overlay)ì„ í´ë¦­í–ˆì„ ë•Œë§Œ ë‹«ê¸° (ëª¨ë‹¬ ë‚´ìš© í´ë¦­ ì‹œì—ëŠ” ë‹«ì§€ ì•ŠìŒ)
          if (event.target === editDepartmentModal) {
            closeEditDepartmentModal();
          }
        });
      }
      
      // ESC í‚¤ë¡œ ëª¨ë‹¬ ë‹«ê¸°
      document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
          // ì§ì› ìˆ˜ì • ëª¨ë‹¬ ë‹«ê¸°
          const empModal = document.getElementById('editEmployeeModal');
          if (empModal && empModal.style.display === 'flex') {
            closeEditEmployeeModal();
            return;
          }
          
          // ë¶€ì„œ ìˆ˜ì • ëª¨ë‹¬ ë‹«ê¸°
          const deptModal = document.getElementById('editDepartmentModal');
          if (deptModal && deptModal.style.display === 'flex') {
            closeEditDepartmentModal();
            return;
          }
        }
      });
    });
  </script>
</body>
</html> 